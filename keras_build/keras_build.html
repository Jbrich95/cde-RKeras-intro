<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Building our first model</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>This report was automatically generated with the R package <strong>knitr</strong>
(version 1.39).</p>

<pre><code class="r">---
title: &quot;Building a Keras model in R&quot;
author: &quot;Jordan Richards&quot;
date: &quot;29/6/2022&quot;
output:html_document
---
</code></pre>

<pre><code>## Error: &lt;text&gt;:8:0: unexpected end of input
## 6: ---
## 7: 
##   ^
</code></pre>

<h2>Building our first model</h2>

<p>Let&#39;s begin by loading in the required packages as well as linking up to the Python environment where we&#39;ve previously installed Keras and Tensorflow.</p>

<pre><code class="r">require(keras)
</code></pre>

<pre><code>## Loading required package: keras
</code></pre>

<pre><code class="r">path&lt;- paste0(reticulate::virtualenv_root(),&quot;/myenv/bin/python&quot;)
Sys.setenv(RETICULATE_PYTHON = path) #Set Python interpreter to that installed in myenv

reticulate::use_virtualenv(&quot;myenv&quot;, required = T)
</code></pre>

<p>Throughout this markdown, we will build and train neural network models for toy data.
We start by simulating some predictors; 2000 replications of eight predictors on a \(7 \times 5\) grid, i.e.,  \(\mathbf{x}\in \mathbb{R}^{2000}\times \mathbb{R}^{7}\times \mathbb{R}^5 \times \mathbb{R}^{8}\), which are just simply independent Gaussian realistions.  </p>

<pre><code class="r">tensorflow::tf$random$set_seed(10)
</code></pre>

<pre><code>## Loaded Tensorflow version 2.9.1
</code></pre>

<pre><code class="r">set.seed(10)
# Create predictors
X&lt;-rnorm(560000)

#Re-shape to a 4d array. First dimension corresponds to observations,
#last to the different components of the predictor set
dim(X) &lt;- c(2000,7,5,8) #Eight predictors
</code></pre>

<p>Now let&#39;s create the response. We first apply a highly non-linear function \(m(\mathbf{x})\) to the last dimension of \(\mathbf{x}\), i.e., across the eight predictors. We then simulate our response \(\mathbf{Y}\in\mathbb{R}^{2000}\times \mathbb{R}^{7}\times \mathbb{R}^5\) as Gaussian with standard deviation 2 and mean \(m(\mathbf{x})\).</p>

<pre><code class="r">#Non-linear transformation
m &lt;- 2+exp(-4+X[,,,2]+X[,,,3]-X[,,,1])+cos(X[,,,1]+X[,,,5]-X[,,,4])-
  sin(X[,,,6]-X[,,,7])*(X[,,,8])-sqrt(X[,,,2]^2+X[,,,5]^2+X[,,,7]^2+X[,,,1]^2)

#Simulate Gaussian data with mean equal to m
Y &lt;- apply(m,1:3,function(x) rnorm(1,mean=x,sd=2))
par(mfrow=c(1,2))
hist(m)
hist(Y)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" style="display: block; margin: auto;" /></p>

<blockquote>
 All of the predictors here are on the same marginal scale. Typically his does not hold for real data; it&rsquo;s good practice to marginally normalise or standardise your predictors to increase the numerical stability of training. 
</blockquote>

<p>We want to build a neural network model that can estimate \(m\); this is equivalent to doing least-squares/expectation regression, i.e., modelling \(\mathbb{E}[Y|\mathbf{X}=\mathbf{x}]\). We know that there is no spatial/image or temporal/sequential structure to the predictor set \(\mathbf{x}\) and so we will create a simple densely-connected MLP.</p>

<p>The first ingredient for a Keras model is the input layer. We can specify this using:</p>

<pre><code class="r">  input.lay &lt;- layer_input(shape = dim(X)[2:(length(dim(X)))], name = &#39;input_layer&#39;)
</code></pre>

<blockquote>
Models in Keras/tensorflow act on a data type referred to as tensors (hence, tensorflow!). These can be thought of as analogues to R arrays (or np.arrays in Python) (see https://www.kdnuggets.com/2018/05/wtf-tensor.html). A 1D (or rank-1) tensor is a vector, a 2D (rank-2) tensor is a matrix, etc. We will refer to the dimensions as the axes of the tensor, e.g., a 2D tensor with shape [2,5] has two axes of length 2 and 5. The main differences are i) you cannot apply standard R functions to a tensor (this will be important when we write custom loss functions) and instead we must apply specific tensor operations from the Keras backend (&ldquo; r
help(k_backend) &rdquo;) which are differentiable functions (required for backpropagation) and ii) they are immutable, i.e., you cannot update the contents of a tensor or change its shape, without creating a new one.
</blockquote>

<p>Note that I have specified the argument <code>`r
shape`</code>
in the input layer as the shape of the tensor \(\mathbf{x}\) excluding the first axis, i.e., the axis that corresponds to observation indices.  Layers in Keras models are built for tensors of a specific shape. Although you can pass new input/ouput data to a pre-built Keras model, the shape of the corresponding tensor must be exactly the same bar the first axis. We specify the <code>`r
shape`</code> 
in the first layer so that Keras knows what to expect when we input our data; it needs to know how much memory to request, how many parameters to store, etc. Specifying <code>`r
shape`</code>
should only be necessary for the first layer as the next layer will act on the tensor <code>`r
input.lay`</code>
, the shape of which is determined already by <code>`r
shape`</code>.</p>

<p>The next step is to add some hidden layers. We will build a network with three hidden layers of 16, 12 and 12 neurons each. The first layer can be added as so:</p>

<pre><code class="r">  hidden.lay &lt;- input.lay %&gt;%
    layer_dense(units=16,activation = &#39;relu&#39;, name = &#39;hidden_1&#39;)

#We could similarly write
#hidden.lay &lt;-  layer_dense(input.lay,units=16,activation = &#39;relu&#39;, name = &#39;hidden_1&#39;)
</code></pre>

<p>We have added a dense layer and applied this to <code>`r
input.lay`</code>. This layer has <code>`r
units=16`</code> neurons, and applied at each neuron is the ReLu activation. Some other examples of activation functions that can be used are:</p>

<ul>
<li>&ldquo;linear&rdquo; - \(h({x})={x}\)</li>
<li>&ldquo;sigmoid&rdquo; - \(h({x})=1/(1+\exp(-{x}))\)</li>
<li>&ldquo;exponential&rdquo; - \(h({x})=\exp({x})\)</li>
<li>&ldquo;softmax&rdquo;, e.g., normalised probabilities - \(h(\mathbf{x})=\exp(\mathbf{x})/\sum \exp(\mathbf{x})\) </li>
<li>&ldquo;softplus&rdquo; - \(h({x})=\log(\exp({x})+1)\)</li>
<li>&ldquo;softsign&rdquo; - \(h(x)={x}/(|{x}|+1)\)</li>
<li>&ldquo;tanh&rdquo; -\(h(x)=(\exp(2x)-1)/(\exp(2x)+1)\)</li>
<li>&ldquo;elu&rdquo; - Exponential Linear Unit \(h(x)=x\) if \(x<0\) and \(\alpha (\exp(x)-1)\) if \(x<0\) for \(\alpha > 0.\)</li>
</ul>

<blockquote>
Here the type of layer applied is &ldquo; r
layer_dense &rdquo; as we are building a densely-connected MLP with dense layers only. We can easily replace this with a different type of layer. For example, we could instead have:

&ldquo;r
  hidden.lay.cnn<-input.lay %>%
    layer_conv_2d(filters=4,kernel_size=c(3,3),padding=&quot;same&rdquo;,strides=1,
                  activation = &lsquo;relu&rsquo;, name = &lsquo;hidden_cnn_1&rsquo;)
&ldquo;
This produces a 2D convolutional layer with 4 filters, a stride of 1 in both directions and a filter dimension of $3\times 3$. Each filter will pass over each of the images (indexed by &rdquo; r
X[i,,,j] &ldquo;) and every time it moves in either direction, it will move one stride. The filter return a new tensor, where the last axis is of length four. The arguments &rdquo; r
padding  &ldquo; and &rdquo; r
strides  &ldquo;
determine the shape of the rest of the tensor; if &rdquo; r
padding=&ldquo;same&rdquo; &ldquo; and &rdquo; r
strides=1 &ldquo;, then the input images will be padded and the second and third axes of the output tensor will be the same as those of the input tensor. If  &rdquo; r
padding=&ldquo;valid&rdquo;  &ldquo; or  &rdquo; r
strides!=1  &ldquo;, then the output tensor will have shorter second and third axes, dependent on &rdquo; r
kernel_size &ldquo;, see https://www.baeldung.com/cs/convolutional-layer-size. Typically the desired shape of your output tensor will be dependent on the application. If you are performing image classification, then the outputted shape will generally get smaller and smaller as information is condensed; the input may be ten images of size $20 \times 5$, i.e., a tensor of shape [20,5,10], but we may require only a single output from the network, e.g., a single Boolean or categorical value for the entire input. For our purpose, we want an estimate of $\mathbb{E}[Y|\mathbf{X}=\mathbf{x}]$ at all indices in the $20 \times 5$ image; in which case, we would use padding to ensure we get an output image of dimension $20 \times 5$.

Note that 1D and 3D convolution layers also exist, and different layer types can be used interchangeably within a single model. Similarly if we want a recurrent layer, we might use a long short-term memory layer (LSTM). We can add a dense LSTM layer using &rdquo; r
layer_lstm &ldquo; or a convolutional LSTM layer using &rdquo; r
layer_conv_2d_lstm &ldquo;. Convolution layers require substantially more parameters to operate than dense layers, and recurrent layers require computations that must be done sequentially, rather than in parallel; hence, it can be difficult to train either in a personal computer.  For simplicity, we stick with dense layers only.
</blockquote>

<p>Let&#39;s add the final two hidden layers:</p>

<pre><code class="r">  hidden.lay &lt;- hidden.lay %&gt;%
    layer_dense(units=12,activation = &#39;relu&#39;, name = &#39;hidden_2&#39;) %&gt;%
      layer_dense(units=12,activation = &#39;relu&#39;, name = &#39;hidden_3&#39;)  
</code></pre>

<p>Note that the input here is <code>`r
hidden.lay`</code>, not <code>`r
input.lay`</code>. We now need to apply a final layer to i) ensure that the output tensor has the same shape as the data and ii) make sure the output has values that are sensible for our loss function. For the first part, we will just apply another dense layer but with only a single neuron (as we only have one outputted value, i.e., the expectation at each index). For the second part, as the expectation can take any real value, we will just use the identity/linear activation function so that our output can take any real value as well.</p>

<pre><code class="r">  output.lay &lt;- hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;linear&#39;, name = &#39;output&#39;) 
</code></pre>

<p>Then we can build our model and specify the inputs and outputs and look at the summary.</p>

<pre><code class="r">  model &lt;- keras_model(
    inputs = c(input.lay), 
    outputs = c(output.lay)
  )
  summary(model)
</code></pre>

<pre><code>## Model: &quot;model&quot;
## ________________________________________________________________________________
##  Layer (type)                       Output Shape                    Param #     
## ================================================================================
##  input_layer (InputLayer)           [(None, 7, 5, 8)]               0           
##  hidden_1 (Dense)                   (None, 7, 5, 16)                144         
##  hidden_2 (Dense)                   (None, 7, 5, 12)                204         
##  hidden_3 (Dense)                   (None, 7, 5, 12)                156         
##  output (Dense)                     (None, 7, 5, 1)                 13          
## ================================================================================
## Total params: 517
## Trainable params: 517
## Non-trainable params: 0
## ________________________________________________________________________________
</code></pre>

<p>We now need to compile our model and assign it some loss function and an optimizer. We will use adam (<a href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/">https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/</a>) which is a popularly applied adaptive learning optimisation scheme.</p>

<pre><code class="r">model %&gt;% compile(
  optimizer=optimizer_adam(learning_rate=0.0005),
  loss = &quot;mean_squared_error&quot;,
  metrics=&quot;mean_absolute_error&quot;
)
</code></pre>

<p>The loss function we will be using is the MSE. For a full list of standard loss functions, see <a href="https://keras.io/api/losses/">https://keras.io/api/losses/</a>.  Custom loss functions (and optimisers) can be written, e.g., the negative log-likelihood for statistical distributions (more on this later). We can also output other standard performance metrics; here we are returning the MAE as well. Note that the metrics are not used for training, only the loss function.</p>

<p>Now let&#39;s train the model. We will train it for 2000 epochs using mini-batch gradient descent with a batch size of 500:</p>

<pre><code class="r">  history &lt;- model %&gt;% fit(
    x=X, y=Y,
    epochs = 2000, batch_size = 500
  )
plot(history)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" style="display: block; margin: auto;" /></p>

<p>And that&#39;s all there is to it! We now have a trained neural network that can provide predictions for \(\mathbb{E}[Y|\mathbf{X}=\mathbf{x}]\). The final training loss (and MAE) is:</p>

<pre><code class="r">model %&gt;% evaluate(X,Y, batch_size=2000)
</code></pre>

<pre><code>##                loss mean_absolute_error 
##            4.069938            1.602595
</code></pre>

<p>and we can retrieve our predictions using</p>

<pre><code class="r">  predictions&lt;-model %&gt;% predict( X )
</code></pre>

<p>Let&#39;s compare these to the known values that we simulated from:</p>

<pre><code class="r">par(mfrow=c(1,2))
hist(m,breaks=seq(min(m,predictions),max(m,predictions),length=50), 
     main=&quot;Predictions (red); m (grey)&quot;,density=TRUE)
hist(predictions,add=T,col=&quot;red&quot;,
     breaks=seq(min(m,predictions),max(m,predictions),length=50))
plot(predictions,m)
abline(a=0,b=1,col=&quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-14" alt="plot of chunk unnamed-chunk-14" style="display: block; margin: auto;" /></p>

<p>Looks to be doing very well! Better predictions can be achieved by using a more complex architecture, i.e., a wider and deeper network, training for longer or just using more data!</p>

<p>We can save our fitted model using:</p>

<pre><code class="r">model %&gt;% save_model_tf(file=&quot;prediction_network&quot;)
</code></pre>

<p>Now let&#39;s compare our deep learning model to a linear regression model. For fair comparison, we will use the same optimisation scheme and build a linear regression model in Keras:</p>

<pre><code class="r"> linear.lay &lt;- input.lay %&gt;%
    layer_dense(units=1,activation = &#39;linear&#39;, name = &#39;linear_1&#39;)
model.lin &lt;- keras_model(
    inputs = c(input.lay), 
    outputs = c(linear.lay)
  )
  summary(model.lin)
</code></pre>

<pre><code>## Model: &quot;model_1&quot;
## ________________________________________________________________________________
##  Layer (type)                       Output Shape                    Param #     
## ================================================================================
##  input_layer (InputLayer)           [(None, 7, 5, 8)]               0           
##  linear_1 (Dense)                   (None, 7, 5, 1)                 9           
## ================================================================================
## Total params: 9
## Trainable params: 9
## Non-trainable params: 0
## ________________________________________________________________________________
</code></pre>

<pre><code class="r">  model.lin %&gt;% compile(
  optimizer=&quot;adam&quot;,
  loss = &quot;mean_squared_error&quot;
)
</code></pre>

<p>So here I&#39;ve taken the same input layer, but I&#39;ve not used any hidden layers. Instead, the output layer just sums all of the inputs, adds a bias and then applied a linear activation; this is exactly linear regression!</p>

<p>Then we train the linear model:</p>

<pre><code class="r">  history &lt;- model.lin %&gt;% fit(
    x=X, y=Y,
    epochs = 2000, batch_size = 500
  )
plot(history)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-17" alt="plot of chunk unnamed-chunk-17" style="display: block; margin: auto;" /></p>

<p>and we get:</p>

<pre><code class="r">  lin.preds&lt;-model.lin %&gt;% predict( X )
  model.lin %&gt;% evaluate(X,Y, batch_size=2000)
</code></pre>

<pre><code>##     loss 
## 5.746709
</code></pre>

<pre><code class="r">par(mfrow=c(1,2))
hist(m,breaks=seq(min(m,lin.preds),max(m,lin.preds),length=50), 
     main=&quot;Predictions (red); m (grey)&quot;,density=TRUE)
hist(lin.preds,add=T,col=&quot;red&quot;,
     breaks=seq(min(m,lin.preds),max(m,lin.preds),length=50))
plot(lin.preds,m)
abline(a=0,b=1,col=&quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAGwCAIAAABHLKd9AAAACXBIWXMAAAsSAAALEgHS3X78AAAgAElEQVR4nOzdd1wT9/8H8M9lhxEIW0BAZCqKFpWlCDIc4MSNC7X9Omud1VpH66oWcWutWtzbYhURZSniBuusuFhKkBFWIDu53x+X5pditZAEIvB+Pvro4+5y+dz7UF5+bn0O4Z8HKysrhJCrq2uPHj3s7OwQQgihRYsW4Tj+/v17Ynbp0qXFxcUSiSQ2NhYhNHfuXOK7fn5+CKGLFy9eunQJIeTo6CgQCHAcnzRpEkLIzc0Nx/Ha2lqEEIPBwHE8JSUFIeTs7CyVSnEcHz9+PIVCOXDgAI7j3bp1QwhlZWXV+8qNGzcQQu3bt6+ursZx/I8//kAImZubq5Z38+ZNHMePHDmCEOratSuO49euXUMIdezYMS8vD8fxNWvWzJgxo7CwUHXHT548iRDauXMnMauVnSUEBASQyWS5XI7j+MGDBxFCPj4+9X7sr1+/RghhGJabm4vjeO/evRFCEyZMwHE8OTm5XoP/WvCbN28wDNPT06uoqMBxPCIiAiE0cuTIRu1LXV1dI/++ANAkKOhz8uLFC2LC2tp69OjRa9asUX5Ep9O///57fX19hNDjx48RQjt27NixY4dyhWfPnolEIoTQ4MGDGQwGQmjy5MmHDx/u8+4dWrr0XXl5FELdpdKSuXNPCAQIod69e5PJZITQsWPHjh079unCHj16RLTMYrEQQgMGDNDX1y8rKysuLiaRSAghNptN/Hr36NEDIcTn8xFCvXr1Mjc3f/PmTYcOHdzd3fv3779o0aL27durtszlchFCRLOa76xqI8bGxjKZrKqqis1mT548efLkyR/bu/bt23fo0AEhZGtrixAKCgoiFiKEpFJpvZXrFfzw4UMcx/39/dlsNkIoMjIyISGhsftCxGhLMWLECB6Pp+sqgJZVVlZmZWV9XoF47dq1vn37/utHhoaGxC8VQohCoSCEZs+e3adPH+UKrq6uRK4RCYX+/mWura1FGze+R4iO0EKp9NnOnTn+/gghExOThheG4zhCCMMwYpZGoxkZGdXV1UmlUhqNhhAislV1HYQQk8nMyck5c+bMhQsX0tLStm7dumfPnqysLA8PD+U6xE6VlJRoZWdVCQQChJCent5/7p2yEYJyX/5VvYKJ6Cd+CAghIp0buy//WeFnpbKyMj09XddVAC0j+gGk/1zvM9S5c2eEkL6+/pgxY8aMGVNdXZ2VlYVhGPGrdfHiRaL3dOrUqX/9OtGXSUlJIUJk8uTJhoaGR48eVa7wYbh4enoSLRPH0deuXeNwOKampvW6e/UkJSX9/PPP9vb2ly5dKi8vDw0NFYlEGRkZquvY29sjhIhDV+3u7Lt376ysrOh0OkJIKBSWlJRUVFR8otoGqldwp06dEEIZGRlEp+n333//xHc/ti+aVwWAduj6mF2BOId47dq1Dz8iTkWZmZkpl1RXV5ubm5NIpKioqCFDhiCEOnbsWFtbW1FRQXRGnJ2dfX19id+0cQjhCF1DaCpCOEJPEZo1axZxrtDT0zMwMBDDsHbt2pWXl+M4PnToUITQoEGDHj9+rHoOEcfx0NBQhFCHDh2GDRtGbGXXrl0flpeTk4MQcnJywnE8MTERIWRgYDB8+PBRo0YxmUwqlfrkyRPVvRMKhUwmMygoSCs7qzzlV1lZiWHY2LFjidlPn0N0cHAgZseOHYsQOnjwYL0d+UTBOI4T3T1HR0dvb2+iDNVziA3Zl3/9K/HZCgwM1HUJQPuIP9YW2UNksVg3b97s379/YmLi3bt3J02alJGRoa+vz2azk5KSgoODS0tLeTzerl27/vXrGIZdvXp10qRJ5eXlf/7554ABA1JSUkxNTRFC8+fP9/LyysjIKCoqqvet8+fPL1iwgEKhpKSkuLm5HTlyZNasWZ+uc+DAgUeOHHFzc0tLS7t8+XKXLl3Onz+veryMEKLT6SNHjszMzCwvL9fizp47dw7H8QkTJny6QjV8WPDvv/8eGRlZUVEhFou3bdv2ie9+bF+0XiQAatJ1LjctDofzYQ9x9uzZuq7rH/78808Mw2JiYrTYpre3t7u7O3GJmZCSktK/f3+tNK5aMJfLPX/+/OXLl4mPNm/ejBD65ptvtLKhzxP0EFulFtxDbGW6des2derU2NhY4myg5tLT0+/evbtlyxbl6bmXL18uXrx4/PjxWmlftWCZTBYVFTVw4MDly5dv2bLl559/JpFII0eO1MqGAGhmn9dV5jZr48aNvr6+XC7X2tpa89ZoNNqpU6f69++vXCIWi3fs2OHv76954wTVgpOTk7///vs9e/bIZLLOnTvv27dPixsCoDlBIH4WTE1Np02bpq3WPsyjeicuNadasK+vb2pqqnbbB0An4JAZAAAUIBABAEABAhEA0IZUV1cvXbo0ODh46NChaWlp9T6FQAQAtBUymWzMmDG9e/dOTk7et2/ftm3b6mViWwxEHMd1XQIAQAeePn3q7OwcERFBIpEsLCx+/fXXPXv2qK7QFgORGPUAANDWlJWVEU8JE0xNTauqqlRXaIuBCD1E4ODgYPi33NxchNDBgwfd3Nzc3d3j4+N1XR1oKt26dUtNTVWO3pKQkNCzZ0/VFeA+RNDmSKVSEomkOqZhcXHxmjVrsrKyhEKhn59faGiogYGBDisETcTMzOzLL78MCwsLDg4uKioqKCg4ffq06goQiKDNKSwsrDduW2JiYkREBDEuHHGfOTHuEWh9xo0bFxYW9uDBA3Nzc2LUK1UQiKDNycvLKygo8PT0LCsri46OXrduXVFRkTIi7ezsOByO6voymezw4cMSiYSYLSwsbO6KgVaZmpoSo/l9CAIRtDkWFhbLly+fPn16aWlpcHCwt7e3XC5XDoSB47hMJvvE1+sNbw5aEwhE0OZ07tzZw8MDwzBLS8vBgwc/efLE2tqaGBAXIcThcHx8fFTXJ5PJ0dHRytlvv/22WcsFzagtXmUGbVxMTMz48eNlMllFRcXly5f9/PzCw8MTEhL4fD6Xy83MzAwODtZ1jUA3oIcI2px58+YtWLDA3d1dKpXOmTOHeLvQsmXLAgIC5HJ5bGxsvZcggrYDAhG0OXQ6/cPXS0RHR6seF4O2CQ6ZAQBAAQIRAAAUIBABAEABAhEAABQgEAEAQAECEQAAFCAQAQBAAQIRAAAUIBABAEABAhEAABQgEAEAQAECEQAAFCAQAQBAAQIRAAAUIBABAEABAhEAABQgEAEAQAECEQAAFCAQAQBAAQIRAAAUIBABAEABAhEAABQgEAEAQAECEQAAFCAQAQBAoS0GIo7jui4BAPA5gkAEAACFthiIJFJb3GsAwH+CaAAAAAUIRAAAUIBABAAABQhEAABQgEAEAAAFCEQAAFBQPxBjYmLc3d1tbW0XLVpELDl48KCbm5u7u3t8fLwmSwAAQDdwtVy/fr1Tp041NTUVFRWenp7nz5/ncDiOjo4VFRUcDsfBwYHH46m3RL16PobD4YxDCEfoGkJTEcIReorQlClTtLsV0KYYGxvrugSgfYGBgTiOU9SL0bKyshkzZhgaGiKEwsLC8vLyysvLIyIi2Gw2QsjX1zc1NVW9JUOHDtVW1gMAQKOoGYiRkZHERF5eXnx8/KVLl06ePNm+fXtioZ2dHYfDKSsrU2NJvQ09evRIKpUS0wKBoHfv3o2qU/ldAAD4T2oGIkIIx/E9e/bExsbu27fPxcVFLpdjGKb8SCaTqbdEdRNisfjUqVNyuZyYPXPmzJs3b9QuGAAAPk3NQJTL5WPHjqVSqffv3ycOeK2trXNycohPORyOj48PjUZTY4nqVmg02vr165Wzd+/eVa9aAABoCDWvMp89e1YsFh87doxIQ4RQeHh4QkICn8/ncrmZmZnBwcHqLdHergEAQOOo2UO8ceNGSkqKubk5MfvDDz/MmjVr2bJlAQEBcrk8NjaWxWKxWCw1lmhv1wAAoHEwvOUMDhgUFJSent6or7x9+/ZbO7vjCF1H6DBCBxB6hlDMlClxcXFNVCRo9dhsdmVlpa6rAFpGxAs8qQIAAAoQiAAAoACBCAAAChCIAACgAIEIAAAKEIgAAKAAgQgAAAoQiAAAoACBCAAAChCIAACgAIEI2q5Vq1bt3LmTmIZXWQAEgQjarBs3bsTExNTV1SGEiouL16xZc/v27bS0tAULFtTW1uq6OqAbEIigLaqurl6yZMmsWbOI2cTEROJVFu3atSNeZaHb8oCuqD9iNgAt1+zZs1etWvXo0SNitqio6BOvshCJRGFhYURfEiGknACtDwQiaHNOnDhhbGw8YMAAZSB++lUWdDr9+vXrylnloMig9YFABG3O8ePHnz59mpqayuVyEUK1tbXt27f/xKssQNsBgQjanIsXLxITGzduRAh9++23RUVFMTExa9euFQgEmZmZu3bt0mmBQGcgEAFANjY28CoLgCAQQVv27bffKqejo6Ojo6N1WAz4HMBtNwAAoACBCAAAChCIAACgAIEIAAAKEIgAAKAAV5kBAK3NjRs3rl27ZmJiMnbsWFNT04Z/EXqIAIBWZfXq1UeOHPH392ez2YMHD37z5k3Dvws9RABA61FSUnLv3r3ExERi9osvvli1atXRo0cb+HXoIQIAWo+XL1/26NFDOevm5lZUVNTwr0MgAgBaDycnJ+UgRgih3NxcS0vLhn8dDpkBAK1Hu3btnJycFi1aNG7cuPfv369fv37fvn0N/zoEIgCgVdm8efOlS5eOHz9uZmZ2+vRpGxubhn8XAhEA0NqEh4eHh4er8UU4hwgAAAoQiAAAoACBCAAAChCIAACgAIEIAAAKEIgAAKAAgQgAAAoQiAAAoACBCAAAChCIAACgAIEIAAAKEIgAAKAAgQgAAAoQiAAAoACBCAAAChCIAACgAIEIAAAKEIgAAKAAgQgAAAoQiAAAoACBCAAAChCIAACgAIEIAAAKEIgAAKAAgQgAAAoQiAAAoACBCAAAChCIAACgAIEIAAAKEIgAAKAAgQgAAAoQiAAAoACBCAAAChCIAACgoFEg8vn8efPmKWcdHBwM/5abm4sQOnjwoJubm7u7e3x8PLFOQ5YAAIBOUNT+ZkJCwi+//CISiYhZqVRKIpF4PJ5yheLi4jVr1mRlZQmFQj8/v9DQUB6P959LDAwMNN0nAABQi/qBWFxc7Orq+vjxY2K2sLCwffv2qiskJiZGRESw2WyEkK+vb2pqanl5+X8uGTp0qPp7AwAAGlA/EL/88svs7GxlIObl5RUUFHh6epaVlUVHR69bt66oqEgZkXZ2dhwOp6ys7D+XqG5CLBaHhobW1dURs4WFhWpXCwAA/0n9QKzHwsJi+fLl06dPLy0tDQ4O9vb2lsvlGIYRn+I4LpPJGrJEtU0ajXb9+nXlbFBQkLaqBQCAD2ntKnPnzp2nT5+OYZilpeXgwYOfPHlibW1dVFREfMrhcGxsbBqyRFv1APAxOI7PmTPH0dHR3t5+x44dxEK4uAcQQgjXQFZWVkhICDG9cePGsWPHSqVSLpfr6emZlpb27t07Z2fnurq68vJyBweH6urqhiz5xOYCAwMbW2FhYeE4hHCEriE0FSEcoacITZkyRc0dBq3ChQsXQkJCpFJpSUmJkZHRu3fvOByOo6NjRUUFh8NxcHDg8Xif+LqxsXGzlQqaDREvWjtknjdv3oIFC9zd3aVS6Zw5c4jD22XLlgUEBMjl8tjYWBaLxWKx/nOJtuoB4GPYbPZ3331HJpMtLCzat28vEonS09Ph4h5AGp5D9PLySk5OJqbpdPquXbvqrRAdHR0dHd3YJQA0qd69eyOEfvvtt99++y04ONjR0fHo0aOfuLiHEHr06JFUKiWm5XJ5c1YLmpPWeogAtCwhISFkMnnDhg25ubmfvrgnFotPnTqlzEGxWNzctYLmAoEI2pyEhIT27dt7enpOnjw5IyMjLS3N2to6JyeH+JTD4fj4+KiuT6PR1q9fr5zdu3dvs5YLmhE8ywzanLdv3/74448ikaiysvLmzZsuLi7h4eEJCQl8Pp/L5WZmZgYHB+u6RqAb0EMEbc706dMfPHjQqVMnuVw+Y8aMgIAA9MEFQF3XCHQDAhG0OVQqdd++ffUWwsU9gOCQGQAAlCAQAQBAAQIRAAAUIBABAEChLQYiPGkAAPhXbTEQlc8kAACAKghEAABQaIuBCAAA/woCEQAAFCAQAQBAoZUHIo7jui4BANBitPJAhOsnAICGa+WBCAAADadRIF65ckU5rjoAALR0GgXixo0b27dvP3v27MzMTDhbBwBo6TQKxLS0tIcPH3bu3HnFihWOjo5Lliz5888/tVUZAAA0M03PIVpaWk6ZMmXevHlubm5bt24dPXp0p06dkpKStFIcAAA0J40C8cCBA0OGDLG3tz9y5EhUVFRpaemrV6/27t07f/58bdUHAADNRqNXCGRmZk6bNu3UqVNMJlO50M/Pb+3atRoXBgAAzU2jHmJcXFzHjh1JJBKXy83IyCAWksnkyMhIbdQGAADNStOrzEOGDJFIJEKh8Msvv/zhhx+0VRYAADQ/jQJxz5492dnZBgYGNjY2d+/e/fBNZgAA0IJoFIgkEolKpRLTVCqVTqdroyQAANANjS6qfPXVV/7+/pGRkTQa7dSpU5MnT9ZWWQAA0Pw0CsSlS5d6enpevnxZIpGsXLly+PDh2ioLAACan0aHzLm5ubdv36bT6QYGBrdu3Vq8eLG2ygIAAC2SyWQNGXhBox7ijBkz7O3tfXx8NGkEAACaTnV19dy5c9+9e0cmk01NTXfs2GFubv6xlTUKxJcvX165cgXGHAQAfLa++eabcePGDRw4ECF048aNWbNmnTlz5mMra3TI7Orqev/+fU1aAACApoPjeEFBAZGGCKE+ffrU1tYKhcKPra9RDxEh5O3t3blzZ2UXND09XcMGAQBAixp1CKtRIK5fv379+vWatAAAAE0HwzA7O7ukpKQBAwYghDIzMw0MDBgMxsfW1ygQPTw85s+ff+vWrdTU1AsXLsB9iACAz83WrVvnzp37888/k0gkU1PT3bt3f2JljQJxzpw5FApFLpcbGBikpKSkp6cfPnxYkwYBAEC7jIyMDh8+LJVKcRxXPln3MRoFYnJy8vPnz8PCwuh0elxcnIODgyatAQBAE6FQGpR1mj7LXFlZSUyXlpbq6+tr0hoAAOiWRj3EJUuW9OvXr66ubvXq1UeOHFmxYoW2ygKg4e7fv793714ul6tcEh8fr8N6QMul6ZMqXbp0SU1NNTAw+OOPPzw8PLRVFgANN23atKioqHHjxum6ENDiaRSIyhFheTzeuXPnzp07t2rVKm1UBUAjiESihQsXNvAkEQCfoNHfIQMDA2KisrLyzJkz3bt310ZJADTO3LlzZ86cOXHiROWInN7e3rotCbRQGgXiwoULldNLly51dnbWuB4AGu3WrVvXr1/Pz89XLklOTtZdOaAF09pRBoyYDXQlLS0tPz//E48fANBAGgWi6oiwjx8/Dg4O1rgeABrN1tY2Pz/fzc1N14WAFk/TJ1WU0wwGo1evXhrX0xzkcnl1dTVCiMFgQK+2FWAwGJ6ent7e3mQymVgCg4wA9WgUiAcPHlSd/eWXX4iJqVOnBgUFadJyk5LJZDKZTCKRCAQCKysrXZcDNLVt2zZdlwBaCY0C0cjI6ObNm2PGjKFSqceOHevduzdx1Pz535BoYmIiEAiIfiJo6by8vHRdAmglNArE1NTU+/fvEzffzJgxw9fXd/v27VoqDAAAmptGzzLzeDwcx4lpHMcrKiq0URIAAOiGRj3ESZMm9e3bd9KkSSQS6dChQyNGjNBWWQAA0Pw0CsR169Z16dLl8uXLYrH4q6++mjZtmrbKAgCA5qfRIbNYLL5x48bjx4937dpFo9FIJI1aAwAA3dIowubMmYPjuHLE7ClTpmipKgAA0AEYMRsAABRgxGwAAFDQKBCJEbPz8/NXr17dt2/f5cuXa6ssAJpUTEyMu7u7ra3tokWLiCUHDx50c3Nzd3eH0bbbMhgxG7Q5GRkZcXFx9+7dk0qlQUFBf/zxR69evdasWZOVlSUUCv38/EJDQ5VjfYI2Rf1AlEgkixcv3rp1q7+/vxYL0gocx0tLSxFCqu/ZAIBQVlY2Y8YMQ0NDhFBYWFheXl55eXlERASbzUYI+fr6pqamDh06VNdlAh1QPxCpVGpNTc2jR488PT21WJBWyOVyPp9vZWVVVVWl61rAZycyMpKYyMvLi4+Pv3Tp0smTJ9u3b08stLOz43A4quuLRKIFCxZIpVJiViAQNGe1oDlpdMhcW1vbp0+fTp06Ef/Yos9ppGIymcxkMmF0L/CvcBzfs2dPbGzsvn37XFxc5HI5hmHKj2QymerKdDp98eLFcrmcmD158mRzlwuai6avEFB9iwAALYJcLh87diyVSr1//z5xmGxtbZ2Tk0N8yuFwfHx86n1F9ZYyeAChFVPnj3bBggXEhLe3t4eHh7cKrdYGQJM4e/asWCw+duwYkYYIofDw8ISEBD6fz+VyMzMzYez3NkudQIyLiyMm+Hy+qampcvmHNy6otwSAJnXjxo2UlBTzv+3evdvGxmbZsmUBAQGhoaGxsbEsFkvXNQIdwRvP2NgYx/GLFy+Gh4dTKBRiIYfDcXR0rKio4HA4Dg4OPB5PvSWf2G5gYGADK5RKpQUFBTiO5+XljUMIR+gaQlMRwhF6ilBUVBSO43w+v7i4WI3dB20c8fcftDJEvKh/DrG4uNjV1fXKlSvEbGJiYr0bFz68laEhS+B2BwCArqgTiHK5nMvljhgx4tGjR9u3byfu9Xv16pXy8Jm4caGsrKzerQwNWaK6IbFYvG3bNuXVvaKiIjWqBQCABlInEIlb/BBCOI7L5XJimoitlStXor9vXPjwVoaGLFHdEJVK7dmzp/L+r9OnT6tRLQAANJA6gSiRSIiJ7OzspUuXEvce/vrrr/VuXKDRaGosUd0QhmGBgYHKWTjVDQBoUlq7o+rDGxfUW6KtegAAoLE0ujFblfLGBblcTty4wGKx1FiirXoAAKCxMPzv1+Z9/oKCgtLT0xuypkwmKyoqsrOzy8/P/65Dh+MIXUfoMEIHEHqG0IaoqKNHjxLvZYYX1YPGYrPZymFAQatBxAs8hAQAAAoQiAAAoACBCAAAChCIAACgoLWrzAAAoENSqXTt2rXEdVcnJ6eNGzeamZk1thHoIQIAWoN169bV1tb27NnTzc3NwcFh2rRpajQCgQgAaA3Onz//+PHj0aNHL1y4sLa2NicnR41XKkEgAgBag8LCwtOnT/fq1cvFxWXjxo08Hq+srKyxjUAgAgBaAwaDcefOHWK6oKCATCaLxeLGNgIXVQAArYGXl9f27dt3795tYGDA4XAsLCxcXFwa2wj0EAEArcHPP/9cVVUVGhoaHBzMZrNnzZrFYDAa2wgEIgCgNXB1dU1MTDQ0NBQKhevXr1fvKjMcMgMAWgljY+MpU6Zo0gL0EAEAQAECEQAAFCAQAQBAAQIRAAAUIBABAEABAhEAABQgEAEAQAECEQAAFCAQAQBAAQIRAAAUIBABAEABAhEAABQgEAEAQAECEQAAFCAQAQBAAQIRAAAUIBABAEABAhEAABTgFQIAgBaMx+PFx8dXV1f37du3a9euUqlUIBAYGhqq1xoEIgCgpcrPzx8/fvykSZNsbW3Xrl1bWlqK47ixsTGPx4uNje3WrVtjG4RABAC0VCtWrPj11189PDwQQi9fvvztt9/u3LnDZrOLi4tHjRqVmppKp9Mb1WDbPYcoEonEYrGuqwAAqO/du3dEGiKEUlNTIyMj//rrL4RQu3bt/Pz8Hj9+3NgG22ggCoXC8vJyCgU6yAC0YMbGxsXFxcQ0hmHPnj1zdHQkZmUyGZlMbmyDbTQQORyOlZUVidRGdx+A1uG7774bN27crVu3Xr16RaFQiouLraysEEKvX7++f/9+ly5dGttgW+wiyeVyOzs7iUSi60IAABrp2bPn3r17f/vtt4qKiokTJ758+bJPnz40Gs3Q0PDAgQNUKrWxDbbFQCSRSBQKBQIRgFbA1dV148aNytmVK1fiOI5hmHqtwTEjAKBVUTsNEQQiAAAotcVDZgBAKyOTyc6ePfv8+XMXF5fRo0erfQMJ9BABAC2bVCodMmRIfn5+UFDQ+/fvBw0aJBKJ1GuqlfcQ1f65AABainPnzgUGBi5evBgh1LdvXwaDcfTo0WnTpqnRVGvuIQqFwoqKCl1XAQBoWs+fP+/Vq5dy1tvbm3heRQ2tNhBlMhmHw7GwsNB1IeAzxefz582bp5w9ePCgm5ubu7t7fHy8DqsCanB2dn748KFy9s8//3R1dVWvqdZ5yIzjuEgkcnJyevfuna5rAZ+jhISEX375RXlGpbi4eM2aNVlZWUKh0M/PLzQ01MDAQLcVgoYbNWrUoEGD6HS6r69vVlbWsWPHEhMT1WuqdfYQMQzT09ODR5XBxxQXF6t2IhITEyMiIthsdrt27Xx9fVNTU3VYG2gsGo12+vRpDMPi4uIkEkliYiKTyVSvKYgM0BZ9+eWX2dnZytFQioqK2rdvT0zb2dlxOBzdlQYais/n6+npvX79es6cOWQyWSgUOjg4TJ48We00RBCIACCE5HK58vEGHMdlMpnqpyKRaMSIEcrB4vh8fnPXB/5p3bp1ly5dMjY2FgqF1dXVJ0+edHZ2RgidPHlyxYoVMTExarcMgQgAsra2zsnJIaY5HI6Pj4/qp3Q6/dKlS8pZNpvdrMWBfzp06BCPx7t58yaGYY8ePQoLC1NeOx07duzevXs1abx1nkMEoFHCw8MTEhL4fD6Xy83MzAwODtZ1ReCjLly4sGTJEqJHb25ubm1tnZycrK1uO/QQAUA2NjbLli0LCAiQy+WxsbEsFkvXFYGPwjAMx3FiWigUvnz5cu3atQcOHDAyMvL19e3du7cmjUMggjbKy8srOTlZORsdHR0dHa3DekADDWwERKkAACAASURBVB8+fMOGDT///DOGYdHR0R07drS3t+fxeM+ePXv+/HlWVpYmjcMhMwCgJYmKirKwsOjdu3e/fv0ePXrEZDJ5PJ6Tk1NycrKJiYkag8KqgkAEALQwS5YsuXnz5ldffWVoaJiampqWljZ58uTx48cTh9I1NTWLFi0KCgoKCQk5evRoo1qGQAQAtEjnzp3z8PB48OABQsjf359KpdrZ2YlEolGjRvn7+6enpyckJNy8efPQoUMNbxMCEQDQIvF4vP379+/bt69fv34BAQECgQDDsICAgFevXm3atOn06dMMBmP79u2N6iRCIAIAWqTevXunpqb6+/vTaDQcx7Ozs5OTk+3s7AICAjIyMg4fPvzy5UsqlSqVShveJlxlBgC0SIsXL+7evTuFQvHx8Tl58qSpqemwYcOioqJCQ0NXr149YcKE9PT0oqIid3f3hrcJgQgAaJFoNJq5ufmhQ4e2bdv266+/ZmVlpaenb9++/euvvw4JCXFxceHz+Uwm88SJEw1vEwIRANAiCYVCfX19BwcHEolUV1fXo0ePw4cPV1VVBQcH19XVXb9+fceOHf7+/o1qEwIRANAiMZlMsVh85syZy5cv375928HBQSQSDRkyJDc319bW9tdff+3Ro0dj24SLKgCAlmr9+vXTpk0bMWKEVCpNSUkZOHAgh8MZP378nTt31EhDBD1EAEDLxWAwJk6c2K9fv5CQEFNT04KCgvz8/E2bNqndoDZ7iA4ODoZ/y83NRf/2noqGLAEAgIYwMTGpqqoyMjLavn373LlzT548yefzL1y4UFxcrF6DWushSqVSEonE4/GUSz58TwWPx/vPJfAuCwBAA9na2paUlEyZMuXy5cs5OTkREREymWzZsmUsFmvWrFkTJ05sbINaC8TCwkLlIOwE5XsqEELEeyrKy8v/c8nQoUO1VRIAoBXjcDiXL1+m0WhOTk6jR49+8ODB9OnTu3btKhQKz507t3v37vDwcBMTk0a1qbVD5ry8vIKCAk9PT2tr6+XLl6N/e09FQ5bUa7agoCD3b/DWeQAAIS0tLSoqikqlisXid+/e9erVy9nZeceOHRYWFjiOL1myxNDQ8NGjR41tVms9RAsLi+XLl0+fPr20tDQ4ONjb2/vD91Q0ZIlqmyKRaOPGjcqF8E5RANqUS5cupaWlGRsbT5o0yd7eXvWj77//3t7efvfu3fr6+n369ImPj7e1tS0vLz9z5szChQvFYnFpaWm7du0au0WtBWLnzp09PDwwDLO0tBw8ePCTJ08+fE8FjUb7zyWqbdLp9N27dytng4KCtFUtAOAzt3TpUrFYPGHChLKysgkTJuzYsaNbt27ER69evcrOzra3t//qq6/Onz+/Z88eOp1OoVA6d+48bdo0JyenkSNH6uvrq/O6elxLNm7cOHbsWKlUyuVyPT0909LS3r175+zsXFdXV15e7uDgUF1d3ZAln9hEYGBgA4uRSqUFBQU4jufl5Y1DCEfoGkJTEcIReopQVFQUjuN8Pr+4uFjzHQdtjbGxsa5LaP3Ky8sHDhyonH337t2wYcOUs5GRkWZmZhKJZMCAAXQ6nUwmk0ikLl26mJqa6unp0Wg0MzOznJycRm2RiBet9RDnzZu3YMECd3d3qVQ6Z84cojdX7z0VLBbrP5doqx4AQMv15s2bLl26KGdtbGyqqqqUsy9evOjfv7+joyOXyz106NDq1avz8/Nfv349ffr0cePGOTs7v3//fu7cuVevXm3sdrUWiHQ6fdeuXfUWfvieioYsAQC0cS4uLtnZ2crZN2/emJub4zienZ39+vVrOzs7oVBYUlLSo0ePnTt3VlRU+Pj4ZGZm8ng8X19fhJCZmRmbzS4tLVW+obSB4EkVAMBnx9jYOCQkZMqUKRMmTCgtLd25c+eePXv69u2bm5vLZrPfvXtXW1srk8mysrJkMhmGYQUFBTKZLD8/X9kCjuPKC7YNB88yAwA+R0uXLp05c+bdu3erqqouXrx49uzZsrKye/funT59OiwsTC6X4zgulUrd3NyGDx8eHR2N43heXl51dTVCKDs7m8fjmZubN3aj0EMEoO16/vz5iRMnxGJxRESEhm80bgre3t7e3t7EdHp6ep8+fTZs2HDkyBErKysrK6v379/L5fKcnJznz5+fOXPG3Nzc1NQ0MDDQ1NSUzWYfOHBAjS1CDxGANkT16Ybk5OSvv/66urr69evX33zzTUxMDLFcKpUuW7aMeM/nqFGjVO//5fP59+7dIy7gNlvNGRkZkZGRL168OHv2bGFh4YkTJ7766qv379/jOE6lUj08PKZPn25mZiYWi93d3U+cOJGUlHTmzBlra2s1tgU9RADahKdPny5cuBAhVFdXFxISsmrVqvXr1yOEPD09Z8yY8eeff86cObNLly47dux49uwZi8U6dOhQt27dHj58OGXKlJSUFIRQenr6/PnzSSQSh8MRCASenp5dunTZsGFDk94ccuPGjU2bNu3bt+/8+fOzZ89OSUmRSCSZmZk4jpNIJBKJ9OzZs9zcXD6fb2Bg8McffwQEBLi5uam9OQhEAFqbO3funD59WiqVDh8+vFu3brNmzbpx40ZJSYm9vf2xY8e8vb1//PHHlStX/vnnn1ZWViUlJba2tu7u7rGxsTNnzrx9+/a4ceOCgoJ8fHwYDIa5ubmDg0NhYWG7du1Gjx4tFouVD5hxuVwymdyjR4+wsLA+ffqEhoY29sHhj4mPjz9+/LhUKo2IiEhJSfnll1+Sk5OvXLni5OT05s2bpKQkJpNJJpOlUqlcLkcI1dbWkkgkDw+PRYsWXbhwwc7ObsCAAeptGgIRgFbl5MmTZ86cWb58OYVCiYmJefLkiVQqXb58eUFBgaWl5YgRI1JTU83NzefPn0+n07t27RoXF3fmzJmkpKSioiIfHx+5XJ6dnX3r1q127dqFhYUhhA4cODBx4kQMw+rq6lxdXWtra2fNmkW89TggIKCkpKSoqGjp0qU7duxYvXp1SEhIw0vNy8u7d++ehYVFQEAAmUwmFu7duzcrK2vXrl0MBmPLli137tyxsLDYu3dvSkqKh4dH//798/LyXr16RVxc1tPTw3Gcz+cHBAQUFxeHhYV17tz5559/hkAEACCE0O7du5OTk+l0OkJo79695ubmK1as6NKly5kzZxBCPB5v5syZBQUFZDLZzMzswoULo0aNunnzZvfu3ZlMpqur67hx4zAM69q1q7u7+/79+xFCOI7fvn2bTqdLJJKXL1+am5tzOJy7d+9iGHbp0iU9Pb0XL16wWKySkpKFCxc+fPiQuNmlqKjou+++KygooFAo06ZNw3E8Li6uqqqqb9++69atI25bPnHiBIVC4fF4Mpns+vXrRkZGCKETJ06kpqYS+bhq1aq4uLjTp0/L5fKQkBAymXzlyhWEkFwuJ5FIbDa7trYWIYRh2MOHD9etW6enp0cmk+sNidAoEIgAtB5yuZxKpVZVVZ0+fZrH43l6ekql0t9++2337t1CoXDz5s3Z2dl3794VCoU9e/bMyMgYPnz4+fPnxWKxiYlJWVlZbGws8RbjrKys+/fvYxhGvNeYWCiVSmUyWUFBwebNm4mLKm/fvsUwrKamxsjIyM/PLykpKTAw0NzcvH///rt27fr+++8HDRqE47iHhwePxzMwMBg/fnxmZqaTk9OVK1d+/fVXZ2fnlStX0mi0b775Zvjw4WlpaQghDMPIZPLDhw+3bt1aUlKir6+/e/fu+/fvW1pavn//nliB+H9dXZ1EIjE2NpZIJDwe78GDB9nZ2b/99tuQIUPU/wlq8rxhM4NnmcHnQOfPMl+4cCEsLKxv374zZ84sKSlR/SgvL69Lly49e/Y8efLk1atXraysqFRqv379AgICgoODmUymkZGRiYkJhmEGBgYODg7m5uZGRkbE1Yl/vY0ZwzAiFj8WIMQKxDSVSnVycjI1NaVQKGQymcFgWFlZ6enpEe0bGRm1a9euoqLCy8uLePBOKBQSZYtEImNjY+LWwvDw8EuXLvXr1+/WrVsnT560s7NjsVienp76+vo0Gk01EDEMo9PpRF+YSqX26dPH2Nh41qxZ6v1UtfwsMwCgGSQlJR09evTs2bOGhoYZGRnjxo27cuUKhUKpqamJiooyMjLicrk8Hu/FixdpaWnl5eUYhl27dg3HcSaTKRKJDA0NJRIJg8EgLhZTqVQ+n4/jOPo7aOohPpJIJB+rB1e5/0Yikbx+/ZpMJhPRRqFQSktLcRy3sLCQSqWjR48+dOhQcHAwl8vNz88nkUhEliGEOBwOi8XicrkMBiMyMnLChAldunQJCQmRy+UUCoXP5+fm5orFYqlUymQyiQ1JpVIMw2QymUwmMzY2dnZ2njRp0siRI8eNG6fJjxfuQwSgJTlw4MCOHTsMDQ0RQgEBAd27d3/48CFCaNmyZV9//fXRo0ddXFzu3LkTExPz8OFDJpPp4OAQHBysr69PnFkrLy+vrKwUCAQ8Hk8ikSjTEP0z2jQhk8mIpkQiEZGMJSUlXC73wIEDAoHg4cOHHA5HLBZzudzg4ODi4uKzZ8+OGTPGwMDg1atXoaGh7969Y7FYmZmZ33333YMHD+zs7PT09AQCAZVKxTBMJBIJhUIiFnEcl8lkFArF0tLyr7/+evbsmbGxsVAo1KR46CEC0JLweDxjY2PlrKmp6bVr13788ccbN25QKJSuXbtWVVXNnj1bJBJNmDDh7Nmz+fn5hYWFYrFYNe8wDNNW/DWcWCwmJmQymUgkIpFI6enpNjY2JBJJJpORSKTevXs7OjpevnyZSqWyWKz9+/c/efJEIBDU1tZiGMbn89Hf3VjiWopyX7p27VpQUJCYmDhr1iwzMzNNioQeIgAtib+//9mzZ4lpiURy5syZq1ev7t+/38vLa8iQIV5eXhKJ5ObNmxKJJC4urqamRiqVikSievHX/GlYj76+vvLknVwup9PpGIbJ5fKKiorq6ur3798LBAKBQBAfH5+fn0/ENxGFym8R7dDpdJlMdvbsWRKJxOVyx48f/9NPP2lSGPQQAWhJlixZEhUVdfjw4aKiouLiYhMTk+PHj1tYWIwaNSo+Pr6iokIsFhMHqsT6Os++DxGHuqrvDpFIJETkVVRUVFRUkEgkuVxeWlpKoVCI+j92Mw2VSqVSqTiOBwcHX7169ffff6/3qrvGgh4iAC0JnU6fNWuWSCT6/vvv582bx+FwfH19ly5d6urq+v79e6FQWFFRgeM4cUH2s0V0XZWzRIKrhjgRl8qLOR+7tRDHcRaLxWazqVQqk8nUMA0RBCIALc7WrVvPnj376NGjo0ePCoXC6urqTZs2hYSEJCQk4DhOIpFsbW0/w45hw9U7Lv6E2tpaDofD4XASExM3btyo+aYhEAFoYXg8nqmp6aFDh96+fbt06VIGg0HcxEeMZCORSAoLC1X7X62ekZHRqFGjpk+frnlTEIgAtCRCobC2trZnz57v37/v0KHDgQMHRCJRTU0N/s8Bolt0D7EhMAzz9PRECOnr6zs7Ox88eFArzUIgAtCSTJs2beLEiXQ6Hcfx58+fl5SUyOVy4hRbqw/Beh4/fkylUhkMBpGMWgGBCECLweVy+Xz+zJkzJ06cSAx/oMZrQ1oH4mypVCrl8/lUKnXNmjXPnz/XvFkIRABajDt37ty4ccPMzGz+/Pk0Go24d0/XRekG8dweQogYe8LX13f+/PmXLl3SsFm4DxGAz1R5efmCBQvevn0rk8m8vLwQQvv27RMKhaampkKhkLh3T9c16gxxzpREIiUmJqalpb169ercuXPh4eHh4eGaNAuBCMBnatq0aQsXLgwICEAIubm5MRgMW1vbly9flpaW6rq0zwWZTK6rq1u1atXgwYNnzpxJjCtBIql/4AuBCMDnqLi4mEQiBQQEyGSyMWPG1NbWvnnzpk3dTPOfiIeg3759+/TpU5lMRrypWZM0RBCIAHxuTp8+PXv2bOI3PDIyMjg42MTEpLq6muj+tNmThh8iXu2yZcuW/fv3l5aWDhkyZNmyZRq2CYEIwOfi9evXubm5X375ZUpKSs+ePf38/G7fvp2SkiKTyVTH6QIIISqVKpFIKBQKnU6nUqkhISFUKrV///4aNguBCIDuVVdXjxs3ztLS8vXr18Sof0ePHq2rq6usrBQKhSQSCdJQFYlEMjMzEwqFIpFo0aJF0dHRcrk8NDRU85YhEAHQMRzHhw8fLpFIDA0N7ezsaDTamDFjKisrZTIZcW8NpGE9xKCzFArF1dVVX18fIVRVVUUMmqshuA8RAB1bsWLFmzdv/vjjj23btonFYuX757744gviSBkC8UO2trZSqfTVq1deXl7l5eVfffXVzJkz1W9OImHKZAh6iADoRFlZWUlJibOzM4VCuXHjhrOzs56e3sSJE69fvy6TyYiHLu7evQtR+K9wHH/79m2nTp3MzMwGDBjg7u4+Z86csLAwJJUiHg9VVqLaWsTjodpaVFODqqoUszweqqlB1dWKjygUJJcj4iIVjfZlbi5qZYGI4/irV69oNJpcLocbFMDnSSaT/e9//ystLbW3t3/w4MHs2bOJ3+qePXu+ePGiffv2yrFq2nIaMhFiI8RGiPGRaVdzcw8jIzaZnM/ndxII0I8/oh9/RBiGjI0Rm42YTMRgIDZbMW1qipyc/n+WwUCWlohMVt3i9qCg4a0sEBFCNBrNwcFBLBbn5eXpuhYA/sXOnTu7des2Z84chJBIJBowYEBpaWlYWNiLFy+oVGp1dbVUKiUuoeq6Ui1gfhBkH5tl/L0+QkiOUDVCAoSECFX+/R8xW4xQJUI8CqW7m9v0OXNuSiSFHE6nRYu0VXBrC0QA1HPw4MGffvoJw7D169cPHz686TaUlpZ25MgRYppMJnO5XDabvXnzZolEoqenV1VVhWHY55aGjco14v/CBuSacrYUoUYd0JHkcn5xca/y8hMnTmj+/LIqCEQAUHFx8Zo1a7KysoRCoZ+fX2hoqIGBQRNty9DQkMfjsVgshFBcXJytre2SJUuys7MXL15cXV3dRBslNDbXEEIChGgI1Xwy15QfNTbX1EahUGpra0tKSq5cuUK8klRrLWuxLQBaqMTExIiICDabjRDy9fVNTU0dOnRoE21r4sSJixYtOnDggJ6e3tWrV4uKiqRS6apVqywsLEpKShrSwn/mGuOf66CP5Jpyul6ulSH0eXVQVRA3IQ0cOPB///vf3r17tZuGCAIRAIRQUVGR8v1EdnZ2HA5H9VOpVHro0CHle46U7xdWT//+/Xk83pAhQ8hicfFffzlYWT05efILPt+Jyaz9SMap5hoVIcm/ddZaVq5pgnhj/du3b5uiQw2BCIDiqVhimnhJpuqnGIax2WzlQhsbm398WSBAQiESCFBlpeK/T8wKhYjBGMlkjpRKubW1Rfr6nNJSl5KSOhJJUFlZh1AVhuUhlI3jylwrR0ijAG5diPc4l5eX6+vra+VO7HogEAFA1tbWOTk5xDSHw/Hx8VH9lEwmjxgxQjnLX7IE9e2LEFLcyGZoiAwMkKEhYrMVEwYGiMVC7dr9/6yRETIyQv8ciCV2+fLw8PBOtraxsbF7yGQcx6Uq71MGH8IwjBgXtqSk5Jdfftm2bZvWNwGBCAAKDw+PiYlZu3atQCDIzMzctWvXJ1Y+6OAwOT1d840yGIz379/7+flt3bo1NDQ0IiLiY69jBwTlvxYuLi579uzR/C3MH4JH9wBANjY2y5YtCwgICA0NjY2NJS4BN53U1NTevXvfuXMnOjr6m2++QQilp6cbGBgQ7wlp0k23dMTzy5WVlebm5k3SflM0CkCLEx0dHR0d3QwbKi0t/eGHH8LDw//6668xY8ZcunTp8uXLubm5ZDJZ2QOCAR3+FYZhdnZ23t7eRkZGr1696tKli9Y3Af8cAdCsMjIySktLra2tf/rpJz8/P4lEUlRUxGAwpFLpmDFjiNNkkIYfolAoJBKJQqHs3Lnz+fPnDg4OTbKVpmgUAPAxf/31l729/eTJk5cuXfr777+LRKK6ujoSiSSXy69cuUImk+Ex/HqIGwBkMpmPj09UVNSaNWt69OjRFJeYUVvuIcrlcqFQWFFRUVFRIRQKdV0OaCvIZPKLFy/Onj177969IUOGiEQiKpVKfESMgQjdw3qIH4ienh6Hw8nKyvL19d2wYUMTbavt9hAlEolYLCaTySKRqLq6msFg6Loi0MrhON6/f/979+6JxeJx48bR6fQ3b944Ozvfv3/fzMysrKyMTqeLRCJdl/nZIZFI58+f79evX1pa2ubNmwcOHNiE22q6pj9/ZDLZyMio6Z5aBUDV7NmzKysrS0pKpk2b9sUXXwiFwrKysidPnjAYjPLycoQQpGE9GIaRyWQGgzF48GB9ff3BgwcPGjTo6tWrTbfFNh2IADSnixcvHj58mE6n79ixo2PHjnK5XCQSyWQyYmwb4oYbuO1GVUhISL33LDs4OBQVFTXdFuGnD0AzwTCMOFt96NChkpKSjh070ul0HMelUilxUUXXBX5eyGTygwcPiDcojBkz5vLlywihy5cv9+zZs+k2CoEIQDMZOHDg1KlTq6qqfv/9d1tb2zdv3gwYMGDChAmqaSiXy5XXWNo4mUzG5XIxDPP39zc2Nv7xxx/9/f2tra179OjRdBuFQASgmezYscPExMTV1fXq1avHjx83NjZevnx57969ieFbGAwGMZjV5zY6rE7Q6XTilszo6OgrV65Mnjx55syZcrl83bp1TbrdtnuVGYBmRqPRUlNTy8rKtm7deurUqcjIyJEjRzIYDIlEQjy0p3pXNvEu5jZ7C45IJCJeQr9//36EkJ+fn5+fX1xcXFNvF3qIADQrc3PzNWvWiMXi27dvYxhWXFxM5CCFQmEwGHQ6HSFEIpECAgJMTExQm7nMohx+DSFEIpFsbGyYTKa1tbVAICAWvnjxwtTUtKnLgB4iABp59uxZfn5+ly5d7OzsGvgVEok0depUmUw2e/bs9+/fe3l5EZdW+Hy+ra1tQUEBQujOnTs4jmMYRozV2Oq7isQOYhhGIpH09PSoVKqXl9eSJUsGDRo0bNiw2trapKQk5btomk6b+McHgKYgl8snT54cExPz/Pnzr7/+es2aNQ3/7ooVK6ytrSdPnhwZGclgMFgs1u7dux0cHGpqaogc9PT0VD61guM4k8lU7UO1PkQU2tjY6Onpbdq06euvvzY2Nh44cODZs2ft7e179eqVkpLSoUOHpi4DAhEANR0+fNjDwyMuLm7RokXnz59/9epVdnZ2A79LJpNnzpy5dOnS2tpaZ2dngUCwefNmd3f3qqoqCoWCYdi9e/fodDqZTEYIUSgU1Epf06ya8jiOv3//3sHBYf/+/ZcvXw4MDEQImZmZDR8+PCwsrHmeJYNABEBNt2/fVn0X1bBhw27dutXwr8fHx+/cudPFxeXw4cN2dnbKYW/YbHZYWJilpWXPnj0tLCyoVCqVSmUymXQ6nTif2Jq6isojZaKHKJVK//rrr8LCQgaDER8fn5qa2sz1QCACoCYLC4vi4mLlLIfDsbS0bPjXd+/effToUX19feImu5KSEjc3NzKZLBAI/vjjDxcXl/Xr11tZWbFYrMGDB9fV1SnPJzbBrjQ3os9L9IWJPZLL5Uwmk0wmd+7c+fnz5xcuXLh48eKqVauauTAIRADUNHny5JUrV758+RIhdPPmzVOnTjVq3AGpVMpkMrds2TJ+/PjHjx/b29v/+eefK1euZDAYhoaGubm5kZGRT548CQwMrKio8PT0VKYhi8Uik8lkMpm4jNNSIpKok0Qi6evrE7cZEQOd+fj4MJlM4iwqg8GgUCjTp09HCBkaGlpaWlZUVDRnkRCIqK6uDh6qB2pwcnLatWvXjz/+2K9fvxMnTpw6deoTg/Tdv39/3rx5M2bMSExMJJaYm5vn5OS4u7unpqYOHDhQIpEsW7bs4cOHL168OH78eMeOHSkUSpcuXdLT07lcbk1NDYZhCxcupNFoNTU1CCESiVReXq5828F/xqJyhWYIUGW/DyFEHOyzWKzJkydTqdSIiIjvvvtuwoQJw4cP79ChQ2Rk5Nu3bykUipmZ2d69e11cXJKTk69du4YQwnG8tLTU2Ni4qav9B7zlCAwM/PQKcrk8Ly8Px3GRSJSTk4PjeF5e3jiEcISuITQVIRyhpwhFRUXhOF5ZWfn69evq6uo3b94UFxc3ffmglfjPv4cfOn/+/ODBgx88eJCTkzNr1qz169fjOJ6Xl+fn57dhw4Y9e/b069cvPj4+LCyMz+crvzVq1Kji4uKKiork5OTs7Ozw8PB3797xeDxLS0s9PT2EEIlEIp5ysbW19fPzY7PZJBLJ2NiYCCPV4FNNKOJs3ccC4T/HmMBUqC4nrv+oroYQotFo7du379evH5VKNTExoVKp7dq1y8zMnDRpkqurq6mpaW5u7o0bN4yMjIYOHVpdXX3gwIFRo0aZmprm5+fPmzeP+EE1D+KPtU33EGUyWWVlpYWFRUs56AAt1LZt206ePNm9e3dXV9edO3cmJiZKpVIHB4eUlJSuXbuamJgcO3Zs2LBhYrGYeHqPYG1tXVJSwmazQ0JCvvjii3Xr1o0ePfr06dMTJ040MjJav369paUlk8nU09N7+fLl+fPniZu6q6qq0D/fykIikRgMhrGxsZOTE4ZhQUFBDAZDmWjKa9no7+G2EEIfG2mCCEoiQdA/Q7De+wJxHCeTySEhIQsXLnRzc1u0aJGNjQ2JRBo2bNj3339/+fJle3t7sVh89uzZc+fO8fn80NBQKpXat2/f3NxcuVy+fPnyPn36LFu2TGt/Bg3Tdm/Mrqurk0qlxB0Puq4FtHI4jhN9OoQQhmEdOnQoLi5u3749k8kcNGiQcjVHR8e7d+96e3sjhIRC4b179zZt2qT81NPTc9OmTdu3b8cw7Jtvvrl+/TqVSqXT6V99jZFW+wAAEvVJREFU9dUvv/ySlZVlaGjYtWvX9PR0HMepVKoy1KRSKY1GwzCsoKCARCLt2rXL2dnZwcGhrKxMLBYTj04rA5QYbov4rnIhhmF6enp8Pp9EIrm4uOTk5MjlchzHjY2NeTyeWCwm1iSetyHOjRJnPMPCwvbv38/lconxmC0tLYkB0GbNmpWZmXngwAF9ff3AwEA3N7fdu3cfP37c0NBQT0/v119/HTlyZDP92fxTGw3EmpoagUBAPECu61pA60e8gtnKyurt27dxcXGpqalRUVEfvlZ4w4YNo0eP7tmzp6mpaVJS0vLly2k0mvLTI0eOnDt3bvr06QKBYMeOHZs2beratauPj098fDydTn/y5EmHDh1u3rypp6eH43hdXR2NRps5c+aWLVvIZDKNRuPz+W5ubgKBwMvLy8LCgs/nI4RYLJalpSWPxystLSWu8zo4OBQXFzs5OWVlZbFYLAqFwufze/bsmZmZSTxD8uLFCyaTKRKJ7OzsRo4c+fLly6SkJJFI5OLi8vbtW7FYTDx3+P33369fv57FYh09enT+/PkcDmfv3r137txJSUmJiIg4cuTIxYsX27VrR+xaz549PT094+PjSSTSqFGjvvjii2b7o6mnlQRiQUEB8U+ZWCxuyPqVlZUmJiaVlZVNXBcACCG0du3akSNHDhgw4OjRowYGBrNnz7506VJGRka9sVssLCxSU1Pv3btXU1Pzv//9j81mKz+Sy+W7d+/OyMggBgcLCgqKioq6cuXKw4cPV6xYkZiYaGJiYmNjM2TIkJkzZ7q7u+vp6Ukkki1bthC/FxQKxdLS0sfH59atW7Nnz7527RoRmp6eni4uLhKJ5MGDB3/99Ve7du3q6urc3d07dOhQUlLy/Pnza9euffnll6ampvr6+t27d79+/fqUKVOePXtWUVFRVlZmbW3dq1evq1ev9urV6+3btzKZrGPHjs7OzgkJCQghgUAQFRV14sSJ7t279+rVq2/fvn379qVQKBYWFoaGhso0JPj4+Pj4+DTHH8YntZJAlMvlHTp0kMvlL168aMjKdnZ21dXVzVAYAAghLy+v+Pj4AQMGTJo0acyYMR07dkQIDRo0qLy83MzMTHVNMpns6+v7YQscDsfJyUk5VKKZmRnxbz+JRFq3bt26dev69u1rY2Pzv//9r2PHjufOnZswYQJCiMlk2traCgQC4h4dKyur4OBg5WF4eHj41atXnz59ymKxqqqqrK2tO3bsiGGYWCwmok1PT2/QoEGdOnWKi4vr2rUrjuOzZ8/Oysp69+4diUTavn07jUbLyclhs9mGhoaLFi1KSkp6+vTptm3beDze1q1bvby8aDTa8+fPBw4cuHHjRmKjPj4+J06caKLXzGtO94F48ODBn376CcOw9evXDx8+vBm2SIyz1AwbAkDJ3NycxWJ99913yiXdunV79epVvUD8GCsrK+IOCuKvLo/Hq3cheOvWrYMHD8Zx3NDQ8NWrVzk5OefPnzcxMRkzZoxynaSkpEePHhHTfD5fIBAEBgbGxcW9ffvWzs5u9OjRdXV1fn5+ZDL5xo0be/bsIdZcunRpZGTk8uXL16xZ8/jxYzKZbGhoKJfLHR0d6XR6QkLCihUrhg0bdu/evZUrV5aUlHz77bcikWjo0KHEzjo7O79586ZDhw7e3t4DBgwoKCi4efMm0YX8DOk4EIuLi9esWZOVlSUUCv38/EJDQ5v/lU8SiaSysrK2thbHcTMzs+a+7wm0Gebm5rm5uY6OjsRsVlbWokWLGvhdCoUSGRk5derUuXPn8vn8tWvXLlmyRHWF7t27//777wsWLIiJienVq9ebN2+OHTt24cIF1XW++OKLmJiYxYsXk0ikt2/f0mg0Ly8vW1tbW1tbhBCNRktKSsrOzsZxfNWqVcpnh4ODg21sbE6ePDl48GCRSMRisfr169ehQ4dTp05JJJK5c+cSXdrBgwcT648YMUJ1o+PHj3dycnJ1dfX39z937lxubu7Dhw9dXFwa/eNrFjoOxMTExIiICOJcia+vb2pqqurDof+JGFkTafbcu0wmo9Fojo6OtbW1cMUZNJ0ffvhhwoQJ33zzjYWFxZEjR/r27UuMeNhA8+fPT09PP378OI1G27x5c+fOneut0KtXrx9++GH16tVCodDCwmL//v312rewsJgwYcKAAQNCQ0MLCwvv3r176tQp4qPCwkIWi0Wn0/38/D7ctJub2+rVq+st9PDwaEjZz549CwsL69Wr14sXL4gxbE6dOrVixYoG7nUz03EgFhUVKa+12dnZcTgc1U9FItGIESOU10ny8/PrfX3kyJFlZWUIofLycgsLC4RQSUmJpaUljuOlpaWWlpZSqbQCoVCEeAhV/j3Bycjo3bu3WCyurq42NzcXi8U1NTVmZmYCgUAgEBgbGwsEAolEYmxsTNyaY2RkxOPxEEKGhoY1NTVkMllfX7+6uppKperp6VVWVjKZTAaDUVFRYWBgQKPRuFwui8WiUqnl5eXGxsYUCqWsrMzExIRMJpeWlpqZmZFIpJKSEuL+x9LSUqLysrIy4sSKckJ5gkk5weVyiTEyP/xI+S1lg8QEjuNlZWUWFhZyuZzL5Zqbm8tksoqKCnNzc4lEUl1dTZyN4vF4pqamIpGorq7OxMREIBAIhUI2m83n8yUSiZGREdGDNjQ05PF4GIYZGBgofwJVVVV0Op3JZFZUVOjr69PpdC6Xa2hoSKPRlD+B8vJyNptNJpMpFEpCQkLbfPWru7v7+fPnT5w4kZOTM3XqVH9//8a2EBQUFBQU9IkVgoODg4ODP7HClClTBg4cmJWVFRQU1KNHjwkTJkyaNKm6ujouLm7fvn2Nrachnjx5EhQUNGnSJGK2vLz8zJkzTbEhrdBxIKo+rI7jeL17O+l0+qVLlz7x9T/++KMJiwNA2ywsLObNm6fbGv6vvXsNafLt4wB+bVp2Mhv8zUpXmzpdtlyRnUiMaM7AohOFEVZiHjpQFBV0IkikA1lBJZ0U0bB647ka2iRnviiVspadTLN0ZjbTypVzbc+L+/4PH32aPt633mt+P6902q/fz2v7st3T6/Lw8AgPDyeEBAUFUS/Lxo4dW1BQ0P1NbRaJxWKVSmX99MWLF9aLBnaI40CcMmXKq1evqI91Op09vO8OMHz4+fkN9uW8kJCQM2fOXL58OTQ09M2bNwkJCfb8DJHjP90LDw8vKCgwGAx6vf7hw4e2n+0DwF+Hz+dnZWXxeLwTJ048fvw4Ozvb09OT66b+iONniJ6engcPHgwJCTGbzWfPnrVu3QEADmPkyJFxcXFxcXFcN9I37n8PMSoqKioqiusuAAC4fskMAGA/EIgAADQEIgAADYEIAEBDIAIA0BCIAAA0BCIAAA2BCABA4/4Xs4eASqWKjY2l9oBh7tu3b0ajsZ/7evbp69evPB6PrU0YW1paRo8ezdZeMk1NTQKBwLovHkPNzc0lJSX2/If9/TRz5sygoKAeN759+7arq4vhxsNms9lsNjs7M31UGo3G7oexDExXV5ezs7MjTWQymXx9fbufa9gd/QeFQ3HiKddKS0uPHDnCVrXs7GzqqApWXLt2LSMjg61qJ06cuHfvHlvV9u3bV15ezla1LVu2UHs+O6To6OiamhqGRVQqFSsnEQ/g5OjeYmNjX79+zbBIUVFRQkIC82ZYmSg+Pv7ly5e2vwcvmQEAaAhEAADasAhEZ2dnJycnFqsxvybyV1SjNri2z2r2hpXp2Fo+FxcX5kWG50Q8C4PTSP4WFovFZDJZj3BkiK3rxBRqk3C28pqVC+FWrFzJHqRq9oaV6di6o7LSzPCcaFgEIgBAfwyLl8wAAP2BQAQAoCEQAQBoCEQAABoCEQCAhkAEAKAhEAEAaI4fiGlpaVKpdPr06dnZ2UzqGAyG3bt3s1L2zJkz06dP9/Ly2rdvH8NqFotl586d3t7e06ZNu3DhAvPeKMeOHbt48SLzaiKRyPVftbW1rPRmP2zM0nuJHb6NPpvRaDTz5s0TCoWJiYlD00yPx6yVrTsh8z0k7JlOp/P29m5tbdXpdCKR6Pv37wOrk5+fHx4erlAomJctKSkJCAj49u1ba2urXC7PyclhUi0vL0+hUJhMpubmZjc3t4aGBuYjazSaMWPGnDx5kuGkXV1dYrG4+y1sLYc9sDFL7yV2+Db6bKa9vV0sFn/8+NFgMMhkstra2sFupsdjtj9NWhx+t5u7d+8uX75cIBBMnjx54cKFarV6YHWampr8/f1ZKdvS0hIfH+/q6ioQCJRKZV1dHZNqAoHg0KFDTk5OEydOFAqFnZ2dDEdub28/cODA9u3bmU/64cMHoVDY/Ra2lsMe2Jil9xI7fBt9NpOXlxcWFubl5TV69OiKiooed4zB0OMx258micNvENvY2Gj90U+dOlWn0w2sTkxMTGVl5bNnz5iXXbt2LfVBXV1ddnb2nTt3bt26NeBqwcHBhJDU1NTU1NSlS5d6e3vfuHGDycg7duw4duxYVVUV9SmTSevq6urr6+VyeUtLS1RUVGJiIlvLYQ9szNJ7iR2+jT6bqa+v//z5c2Bg4NevX9etW5eUlDTYzfR4zPanSeLw1xDNZrN1pwOLxULtpMB5WYvFkpycHBoaevXqVT8/P+ZNKhSKmJgYlUpVW1vLpNrNmzcnTJiwbNky6y1Mqk2cOPHw4cNPnz598uRJbm5uXl7eIC0HJ2zP0mOJHb6NPpv5+fOnVqu9f/++VqvVaDQ5OTmD3cyf2P6JOfgzxClTprx69Yr6WKfTLViwgPOyZrM5IiJixIgR5eXlAoGAYbWCggKhUCiXyzdv3qzRaIqLi5lUy8zM1Gq1arVar9cTQn78+CEUCgdcbcaMGTKZjMfjeXh4rFix4vnz54O0HEPmypUraWlphJCioiIbs/Re4sFjJ2302YyHh4dSqaSO8VAqldXV1atXrx6Clv6vJglx9DdVGhoaJBJJR0fHly9fRCJRe3v7gEtVVFRYL9AyKXv79u2VK1ey1WRycvKaNWt+/frV2trq7+9fUlLCysgnT56k3lRhUu3UqVMREREmk0mv18vl8uLiYhaXg3O9ZzGbzQ0NDWazufcSO3wbfTbz7t07iUTy6dMnvV4/c+bMwsLCIein+2PW2ontO6GDB6LFYklNTZ0zZ87s2bOzsrKY1On+w2VSdufOnWPHjv3nX5cuXWJSzWg0bt261dvbWyQSURHGpJqVNRCZVPv169f27dslEolYLE5KSmKrN/vRY5a2tjZCSFtb2/9cYodvw3YzFovl+vXrPj4+IpEoMTFxCDqx/PdjtnsnNu6E2A8RAIDm4G+qAAD0HwIRAICGQAQAoCEQAQBoCEQAABoCEQCAhkAEAKAhEAEAaAhEAAAaAhHAkZWVlYWGhhJCSkpKVqxYMXj/UW5ubmRk5ODVHxoIRIBhYc6cOefOneO6C3uHQAQYFsaNG+fr6zvgf97V1cViM3YLgWhHKisrg4OD586dO2nSpI0bN168eFEqlc6aNauiooLr1uCvZ33JXFlZGRYWFhYWJhKJwsLCqMO/KCkpKREREVKpdPLkyatWrdLr9Y8ePVq/fn10dPT+/fsJIVeuXPHx8RGLxbGxsZ2dnWazef/+/Z6enoGBgcXFxYQQg8EQHx/v7+8/d+7czMxMroYdMASifSkvL8/IyHj//v2DBw+qqqq0Wu2GDRsuX77MdV/gUAoLCxMSEurq6oRCIbXlrVVubm5+fn5jY6O7u/uBAwcIISqVateuXefPny8rKzt37pxGo6murnZyctq7d296erparX758mVpaSkViJmZmU1NTdXV1ampqbdu3eJkOiYQiPZl/vz5Uql01KhRAQEBkZGRzs7OQUFB1P7VAGyZMWPGvHnzeDzewoULf/782f1LS5YskUgkfD5/27ZtRUVFhJCAgAC5XE4IUavVHR0dERERSqWyrKysrKyssLBw06ZN48ePd3NzW7duHSEkODi4oqJi79699fX1WVlZnEzHBALRvjg5OVk/dnFx4bATcGDu7u5/+hKfT2fCiBEjTCYTIcTV1ZW6Zdy4cVu3bi0tLS0tLS0vL1er1Xw+3/r91CkFUqn0+fPnixYtys/Pl8lkRqNxcCdhGwIRAMiLFy86OzsJIcXFxdShycnJyQqFovv3KJXK9PT0xsZGo9EYHR1NnQmenp7e0dFhMBgyMjIIIcePHz969OjKlStPnz7d1tZWX1/PzTwDhUAEGO5+//4tk8lqamoIIQqFYsuWLVOnTm1sbOxxWKhMJjty5MjixYunTZvG5/M3b94cGRm5ePFiqVQ6f/78VatWEUJiYmKqq6u9vLwCAwP37NkjkUi4GWmgcIQAANBSUlK0Wu1w/nVFPEMEAKDhGSIA0Jqbmw0Gg1gs5roRziAQAQBoeMkMAEBDIAIA0BCIAAA0BCIAAA2BCABAQyACANAQiAAANAQiAAANgQgAQEMgAgDQEIgAADQEIgAADYEIAED7D0rBx/lZh7/7AAAAAElFTkSuQmCC" title="plot of chunk unnamed-chunk-18" alt="plot of chunk unnamed-chunk-18" style="display: block; margin: auto;" /></p>

<p>A massive difference! The linear model just isn&#39;t capable of capturing the highly non-linear structure in \(\mathbf{X}\) and the neural network provides a much better fit with a substantially lower training loss.</p>

<h2>Avoiding overfitting</h2>

<p>There are a number of ways to mitigate the risk of overfitting. The most common approach is to use validation techniques. Here we hold out some of the training samples and use these for model selection. Let&#39;s use an 80-20 split.</p>

<pre><code class="r">Y_train &lt;- Y[1:1600,,]; Y_valid &lt;- Y[1601:2000,,]
X_train &lt;- X[1:1600,,,]; X_valid &lt;- X[1601:2000,,,]
</code></pre>

<p>Now let&#39;s train the model with the training data, but keep track of the validation loss. To illustrate overfitting, we will use a much more complicated network; this has four layers and over 10000 parameters.</p>

<pre><code class="r">#Here I&#39;m just resetting the model to it&#39;s pre-trained state
hidden.lay &lt;- input.lay %&gt;%
      layer_dense(units=128,activation = &#39;relu&#39;, name = &#39;hidden_1&#39;) %&gt;%
        layer_dense(units=64,activation = &#39;relu&#39;, name = &#39;hidden_2&#39;) %&gt;%
          layer_dense(units=16,activation = &#39;relu&#39;, name = &#39;hidden_3&#39;) %&gt;%
             layer_dense(units=16,activation = &#39;relu&#39;, name = &#39;hidden_4&#39;)

output.lay &lt;- hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;linear&#39;, name = &#39;output&#39;) 
model &lt;- keras_model(
    inputs = c(input.lay), 
    outputs = c(output.lay)
  )
model %&gt;% compile(
  optimizer=&quot;adam&quot;,
  loss = &quot;mean_squared_error&quot;
)

  history &lt;- model %&gt;% fit(
    x=X_train, y=Y_train,
    epochs = 500, batch_size = 200,
    validation_data = list(X_valid,Y_valid)
  )
plot(history)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAGwCAMAAAD/kMAYAAADAFBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7////isF19AAAACXBIWXMAAAsSAAALEgHS3X78AAAgAElEQVR4nO2dB2AUVfrA55XpO9s3vYc0QggklHQIhF4EEekooIAKiIIinOLhiYCAqAge2DsIIgiKZ0FR/MsJinKKBSkCAgKGgAIJKe8/kwChLpvd2SQT3u+Oyew4++23+WVmvvdm5g1DKIaCqesEKDWDCjMYVJjBoMIMBhVmMKgwg0GFGQwqzGBQYQaDCjMYVJjBoMIMBhVmMKgwg0GFGQwqzGBQYQaDCjMYVJjBoMIMRg2E7WuVTvEAs6QPqb4K2zrW83WvZdrqFMd62aVUmO5QYQaDCjMYVJjBoMIMBhVmMKgwg0GFGQwqzGDUU2GnKnzKpgFTLaziVPXSb5vVNI6uwn7s2Dn7nrKapnBtcFZY2YTsLp1/PLu0boWV5uwi5LFZNU3h2uCssBmPE7Izt/TMK03Ysnjn9YdJ2Sin84EzU3foKaxytqy95++9ljgrrL22Bxr7vzOvVGG/2r4qGTmQLGteuMv8c9XUXRz9hRV4/t5riQuEjTlP2JwRhPzBV3wS9Vk5IVVTd+i7S9xJyJzZnr/3WuKssFlzCdmRe/ZArwqbOE39KRypeDjGNrakauoujr5FR5dOOZOu8hdyrXKu6Lgnp1PXczs9bQu7hZAjXPmeA+THZm9WTd3F0bmsL6Zl/RU4r6wvrl6qCvvFvqX0thvJ7A6/F7Z4sWrqLg5tONcSl284a1Xi0nhX70PkeE9zwG2lVVN3caiwWqKe9nRQrgQVZjCoMINBhRkMKsxgeCCsuifYTZ8wFVZLnBX2yDF1snjH5VahwuoTZ4WtLzhG5g072x3U/gVCZgwgT0QprX+6SNgVOvGpsFri3C5xfcGMc77IU30IyVi1W/hf8ehRFwq7Uic+FVZLVB/DxoYcPTe/z1xywF5S8gf5c2z/C4VdqROfCqslzgn797BPCo6dW9zyw8XDSemE8Jb5Fwm7Uic+FVZLnBX25M3l5IN2f51d/Mj4rh+S19OOkJcv3sKu0IlPhdUSZ4W9re3bvjhwdvG2iIgyMr/d6aKc6y8UdqVOfCqslrhSOyxhDCFFBYE5rwWtuLBKvEInPhVWS9CeDoPhkbAfR1cywc0qVFgtUR+3sJJCbXrQt4QaKvVR2G+Z+wh5aaivKTVM6qMwsi1n3xs9i6+87rVMvRRGtiV0oL4uT/0UdpfF0nqNbwk1VOqlsBlBRdsy2/545ZWvYeqjsO0pHxDyXf4cX3NqkESO1Addt7AHP1Un7z7q2zdroPy4WR8yLxvdS2Ff3XCaFPf435VXpvjM5Xet3hYdr2T2yFruW0IU9+grjJDjviRDuTp6C6P4GSrMYFBhBoMKMxhUmMGgwgwGFWYwqDCDQYUZDCrMYFBhBoMKMxhUmMGgwgwGFWYwqDCDQYUZDCrMYFBhBsNzYZEmk2nHBTOVUGG1i8fCSqMvnqmCCqtdPBa2I+/imSrOF7bie3XyzWp9MqNcFo+FfRTZNHjKBTOE/P7hhx8+3bd6nb2ZW8mWzN91T5JSjcfCti6uOJi86vwZQr6eOXPmkEbnrbQ3803qy794LKy8gpD7Hj5/poq3Lniw8PvKx7qmR7kYj4XN6l/2Z+q6in0VVTPnll8gbEvmZnWvSPEjHgsrvj0uei4pYoqqZs5xvrBvsg6QPZnf65wi5Xx8bjifL+xTbUSevRt8y4jiFl2FUfyPzsI+GdRrgdsHG1B8RF9hq3rvLJo3wreMKG7RV1jHv9VJzyM+ZURxi77CKqON+86XhCju0VfYALURVpJJx1bxI/oK25P18MKCZb5lRHGLzlVi8dql+33Kh3IVaDvMYFBhBoMKMxhUmMGgwgwGFWYwqDCDQYUZDCrMYFBhBoMKMxhUmMGgwgwGFWYwqDCDQYUZDCrMYFBhBoMKMxhUmMGgwgwGFWYwqDCDQYUZDCrMYFBhBoMKMxhUmMGgwgwGFWYw9BU29Zg6mbPHp4wobtFX2Pq8QjL1Lt8yorhF513i+rx7qS+/ovcx7KawQl/SoVwNnYU9cPdnedSYP9G56JhIyEf5f/mWEsUd+gr7QJtsopuYH6HtMINBhRkMKsxgUGEGQ29hB5Z/UOJLPpSroLOwt9o/8VDOPp8yorhFX2Elmerm9d1A31KiuENfYVXP9bh8TIou6CvsSE918ndHnzKiuEXnY9iwJ/7a0+cdnzKiuEVnYaef7DFg3ZVWpegAbYcZDCrMYFBhBoMKMxhUmMGgwgwGFWYwqDCDQYUZDCrMYFBhBoMKMxhUmMGgwgwGFWYwqDCDQYUZDCrMYHguLNJkMu3QZl5ISFxRvZgKq108FlYafWZmf0zh/qjqW8CosNrFY2E78s7MPDuOkAErzy2nwmoXj4V9FNk0eIo2M202IZMWVi57v2/fvllR/kuOcikeC9u6uOJg8ip15sE5hNw7v3LZ6cLCwpdS/Jgd5RI8FlZeQch9D6szi+4iZHB11UF3ibWLx8Jm9S/7M3Vdxb6KfXEnjkQdO7ecCqtdPBZWfHtc9FxSxBSR59Ob07K+zqANZ4NBhRkMKsxgUGEGgwozGFSYwaDCDIa+wvYOLiHk1yG+pURxh85b2NIexbsytvmUEcUteu8Slxa0or78id7CdsflF/uSD+Uq6Cxsd8a2JT2pMT+ir7A/Mn4h5JUBvqVEcYfOY039oU33+pIQxT20HWYw9Ba265b84dt9SYjiHp2FHcraTL7L/t2nlCju0FnYv19VJyvn+JIRxS06C3voY3Xy1T2+ZERxi87CPhynTqasvMK6FN/Ru+iY0HfugDt8SYjiHt3L+h2rf/EhHcrVoO0wg0GFGQwqzGBQYQaDCjMYVxNWcrWajwqrXdwKe61HaXzALPcBqLDaxa2wFlvfGXk0wn0AKqx2cSssvmzs0mKn+wBUWO3iVtjIniGFt+e7D0CF1S5uhf39zE9k2gH3Aaiw2oVWiQaDVokGg1aJBoNWiQaDVokGg1aJBsOtsFMzC9o9csp9ACqsdnG/S+y6ZHm30e4DUGG1i1th4acJKb3KaG1UWO3iVlj0EUIKY90HoMJqF7fC5sbcMyl2tvsAVFjt4r5r6pMpkz++SgAqrHahlwgYjCsLKziL+wAXCnvh+Xm5+TkP65Ud5RKuLGzDWdwHuFBYWesOZcty25TrlR7lYvTeJXYYcEv3U7fRkR/8ht7C2r0R+gSZsNmXlCju0FtYn+Z/D5qdRQd+8Bs6C1vTfVCXwU5adPgPnYXtKyHHfivd41NKFHfQdpjBoMIMBhVmMKgwg0GFGQwqzGBQYQaDCjMY+gv7Y/n7J73Ph3IVdBe2pu0Tj2Tv8CEjilv0Flbe+gQhv1zvS0oUd+gtbMfwK0el6IDewoZlEVJ2c4YvKVHcobewPUHjC/u0eMOXlCju0L3o2BUTlPYfHxKiuEd3YWV9ov7nQz6Uq6C3sLKhT+3JoMb8h97Cbl2oPc+DPmrAb+gtrFLVEdrV4TdoX6LBoMIMRk2ETZ1f+SPSZDJVdxZeRtihCh0So1yeGgj7TJqp/SiNvmDpJcLeyrwhc4EOmVEui+fCijImVgrbkXfB4ouF/dy1mJTffLW7yije4rmwQWtnVgr7KLJp8JTqxRcLW/CmOvn6bp3So1yMx8Jev4NUCdu6uOJg8qrKZasLCgqaXjS00eLX1cl/J+maJKUaj4V1j0p0ue5XZ8rVkuK+6qvnL3kyRH4hOdn7vzqmSDmfmlSJ6hZWsa9iVv+yP1PXnVt4kbDDuavy89Noqe83aiisiCkqvj0uem71wou3sM1ZB7Zk0ie++Q39G86bU1tQX/5Df2Fbmra4ynhiFB/QXdiWzF8fif7Ih4wobtFb2OGs77KenB4005ecKG7QfQsrGf2lOumy34ecKG7Q/xiWr3X9Tv/A64wobtFf2ECtJ38wfa6in9Bf2Le5G3Y+OtT7jChu8cMJzO333PwiHbvIX+gu7HTl2csSrxOiuEd3YcuHlyzsnDTIh5Qo7tB/lzgvefrDN9+20PuUrl3+Pjc5c/nZsWOXrKO/sNNxLW6tKGvjeQTKGSqyvyHkl4zxh9X5Sbc9SMjhVpdekuuHOzCbZg4rpzccecHkV7M3/RLy3OasA+S+we3vnrQpZOyTH+77k7y87LyV9Bc2K6hw3rDtPWucLuVE55fSXCMI2Zw55K4n3ksZAKWcFqmO0QnhJ84zpruwJWPXp8bZ+XleJHzNcPhFtY6emaG2fe6bWLXkP5+qk+3/zuMsLTYVD2kHBk2ZEAkE0SFC1irvbXbeyOZ+aIcdzFzy0dEb19fkG1wr7NDaPMcPlg97nBSHtW5fflPEqVWlX/xv0OSCzH8OvkX5MDggSghKymXHg7BuEMB4CDjIDGly/rDL+gsrfG2xunV/PbamX8aYlFQ+muaCYm7ydHUy785L133/1IKRFZ+/2HYjKcud3HL2DSEW+8JZ6a0/S38gRuHEKJxgto5S7ACAQU1d6pQTWYQAY0YXXAiqv7BRN79IjuS+P9LzEEZma34RIc/edv6iJXETXuoV/AVZ8tRF677V/dTcPmnmu0n5sPaSNftljoEjbLYERbGILMsAvhWnAE6BDGBNKQKDck1A4pkQzNpmnBdEf2FlvRKfsTZLfNbzEIbms7zC524srX79x+riJaYU2Ol40/Y3TFZf732K9P+JkOIb1IbV8m5L5IAJzvTwua2R2YYgQpALVlgRoGAEgAStQEEYyogxyYzC2jgLhFNQQEhgzqrq+H44hpUlo/zsO3Ov8hirBsFfO1Rj8Z2OFFVe1ld5SumPhLb/bs4ISIxo3FPpT/ZmPrXht4wfSno/d5qUzRxsDolt4QK8icvjAAOi1e3IAtSDlaorkmUQYzdJjD0GKgyjdByMslKUgNyWXXe91uHR6o/0g7DCgDaPlJIHPqvRVzcmX8eOJ89FC2u/bf8fQsZMIBVzK8jBBBviocBwbTs1tfYNmtvir1VNmifPWWFN/TafhZyIeIlh+BgeMiEysgHAqkcrCJQwBTGiEChmIPRSJGLDX+64Kb7H1lF9yIq15IvzjpF+KDraZB4bcM+mWatr/v2NwonKQY1/Vv+tj2jXJGRG3s335qweHfzb90VzbyknGYBL4xmeMcXsTUUC7GW1x/GsrIyXII8hBwBvAQwCThQSipwKBAwfAU0RyBxiskEnGpwSYrVG9B7equlrw98g6tHu4jPB+gu7df3c+7OSB1oa8MW/f2RsI2T+rdrskxyXeGD1iEgl1L6t65oHHpnbZhLvCGMxhwIZfmI0YjBAWAA8wNHqfk8JAdgOQYSJYcHC77mCEFlmhRChhT1mOhfYfOerynhn4e+fdc0m28tunX/5z9Zf2LGMHcGdBpgXd/M8hgG4cUPprye6bCdq/bDjbbInY9WNA0rJicHFUTbZkprWLyoKxaUv6/54hjMAmKZzkLObQXsAMWChtjlFMZKFQSzAnFNiMQwIjYeRIf2/6Ns0OyOtkyu7Y7sOK7/u8rq66X5QerVE/HAM+6lV/kdNlu1uX+Z5EJ0ZWqiWZcMu7en2kLlryEHyzOvkyJnf3q/qv6PpK7IzVm5c0GvY8R0pD926SRBeuWVlk/5xQlQUjyyhIxUJyNeNgAEuBjitYvOWrazN5DzANAlSrTFmJkVhOAbHMVKORbC3xG+1erdn/7ZrHlv9/uKKBXc+s+DgiTmkdKdHyfnjltltckTmlH6BdSdsQ+6Rkt6veP32E51X9UjrV7q7xaiq133Ug8m3CdakRusSzAenZ7Z8hutsjmTN7+BGIhvUiA1gGUdIGtT2fnaBARxmD+4i3+/6ZQgEVpaXsCQwAXa1FhSQaQrL9i6Y0W5y0gFCTp/8zpvk/CFsi0P45ci4znV4G+aGnG418lVxWp2c1k6TazOqsdssbXe3aKF18JE7T5b0Hjk0/a1U3sIHxEhxVpezJcTsIszEYxE7YLyVvZ7BbLBakYNIADpyIHOM1gP1sxnKwcEo0SzIaSLgFWejls6+7z7Xj5DvTm/82+uv5gdhT0Q+0ZkzhbfM9jopnynJSzhSk/V3tikkfyZ3V+v09oT8bx5ZGDxGMjfvufX+3Z92Wl3w9zsC+5wjLBwBZAKsAFinemyyA8TISIQiH9I8mmPYfmMAixjQBzryrYPGV5Cfg+zTHgoIvzF/eUi/Jc6Eoa/f0nLM0fd8/2p+KDqyhw/t08t2/NvQOrsnQt0ffpF7xtgL2unATzZd5R0bcje+3ar1/o2pnw469MeYRP49Ewb8IDbpUcEa0y0QICfUKnQIgJMBPARsMMtwJshYAdesk/1xjO0gl3M6ASOIcWGLFoffVUTuHqQeAR/oRcjxPceOlZMfSEWRLt/NH7vEitFC830vpo1709ukfKWXetD5PO9E5fyXOYfJR4lH1bmlR928ZUOMdc83KeZXFnaLjL0DWADHMQDYMJRMrINhEgWeCQGyoFbmGFghI2ZDFiKzxDSO7JcxEVuSHP1B+LMS29QZ2+arr8jhP/333fwhbP17UrQlbljUHG+T8pXK581tP1Pjbc56u830EeVkweCLqqAXtYdmfbDz+NGiafeTmVEB4W+bnCvIxOYuOBADKEZpnRCM1cQzOJKXGRFEsXwKB9hxjGji2OZKBGsLVoTZYwc3iTF3/zHu/ujY4c+/uTlngp97ePwh7M6gt6Vh8YMia2+Yy5OVG8/l7nI6WUIWm386Om/4ov4XN3GW9jhFVnY+8VPWN62jAiUHJyDUSrrrhBVgiJ0IhbbEDJIYieFgPM8kqptbfJpsdlpROGwjiCl90iYmJJya1Gxa1vL9mzK2b19ftksL+pefv6k/hH3R/l/94qA1c57tZ6/TqiG/Zqmynh510dI3nlGTSW/VZl3k+EdviDl3qeS8CrX6u+nV9w9OaDGm0fbnhq61PR0KWCwDRjKZMKcW4IwsixjfzwLE8owc6QQwlg3kO2XlhufPcSbFzQz4qH/i0cd2jHtb/YPoqf2t7Pymtr6pP4T9WZgzEl//Zou3k2rvJOaWrN+fuWQTKhvy0KG1jaSug5oEd0ke06ycLNytLl17Z49Rc8b0i5W+SZWENrboQSYHJ0oMVLcsm2QFDBcA7JCfkBEFY/OwwJhRqoz5ZqntRzZ7YRIhrx54/AD5vy/Iobq6ttkvY019YEq02vtlJMV5mZQXbIm97tJenbLuQXkvLcFiSmTHBGV01NTgIfcnrE21h0aEmGKjcx3xECl2BEJFBkDWxESG4UAIIERvBedfl74jqeuMji25nsOG8vlPfx37f8XvnLzKM+NrB38I+ymlRSNsjW8zK9artrxXLO6UUdmKKGmj7hz3tpmmFRRPHH7XGfVbSlPRnhneeGH3HNNYhzkAWtpwEGAuRYEgCDIYIgxUHgOSHB6r1uw8q8wp6f2aZv/oibVb1SbBQ6sJOVRv7lD0h7Dpu58y805r38hG93ibluc8vq/i0fJlk/s/trFq7IItmRv2Zm59s91OMnP8e20OdeXSbxri4vmcuUnWOMmE1MZvMK8KkrBJ1RapHq5MDBTZlvDmvPgkyEGlmTM+cHtJ/T035Jdd4ufpqxW2V9uMxEjvkroyG7VLYQ+tJOSgdgw5ffi1k9ty9o1p3WbI5Hv+Wj5k6kby9AfxvPPtHq3DpCYZuc2lTmmCzM+M5LBoknm1oACMBTIshDxQzfFIrTTUVjCUVrryOr67yZ47a3Z8yty5yx7SO20d8Yew4m5zrB2wJUQx8z7uSd7Qrgx597GqF8++RMi+uAdKW7bYSHY1urmclPRevbLLySWRCUk3jSsgRbk9O8WmpphEE0Dpqh1g6gKbYPxYaCgQUlqZAcTqAQqYVVNMxGAkAGCx8DiiLwObBbaL3jxl5qlfd2m5/7ee33jjnwEu70+yh0LceX66a58XOZWv0Kar1N9c2eAFZG3BcfXVT0+QskHzpy7tmP1pepNffwvYOG/Yr9aFhLwZuUw27YgVV0x79PbkOCtC2KS6QCZWULTq3MmxMUFxKG5sAIs0YQFYPWhxnPNWJGBLTGKTxIAHusX9mP3GF16kWTf4p0q873gwwK0CJAEN9CapEdMIeWroXnLiu7LBdxRUDuVXcUerg4cDe0fv+t78ylNNmz3d8o1YOb3XD32b92Uj4kVBkVIFm6KWDwzrApzMwKYOjmF4weZE3NjUsSaLGBwKOeTIdQbimH/Ika60mHxX3qzhbR9Xv8GUq+VTn/DTELIHQxHgpcZj2lqXeJHU1pApiwY8NOmvv9uOWhKQMPLlH/5vxLLZzYKThuAWh5I7tZwmcNfFijywulgz5iTezMBgnsUcy0BgQ4xVhibIxzKiAARWTBLZB7Y1BXySNUhMC7e2avL5ghuON+tPTh1Z8JDXpzjrEP8IO5iZaWEYexzmHS0rF/xTu5Zk+rtXDtNXrcZP3Hi2Q/sLa+OZI/dmTdzViE8wRTQbERg8rCAacMgVEZnaReQDIYoGQISQAcEYmxjMOVU/mq8ojkE8K9tiIdNM4RWGkyI6mUIzbmgf1uiGPc9umnjnEbXt/JGRh7j1j7BpGW/mmRiAcBRGa7Qmzd8d15BZQ7UBcsouv8ltyfz9RJe3D09Wf5d/DS67rY05dOlHs5PCYgBuarPioEQ7ByQA0u2c6g3DaO1CCZOVgSxQOGCxWwQQhBkONjWDwCirrf9UU3hM4oyM6Bg5M+qpY0Et5pGiriOXev6l6jF+2iVuzv+wJVQLMIFF8NbFRDM2bNTJritI2ZDqE9GLXiC/k0XPkMKT379HtrRuM/7oo9NTF18X2T8inuehS7xe4EAgA26UMXYwjAyhhbdzTDILTJJaP3REjKgV6gKvdAkGZgmxQoZNaLJx2PVPrMl84fOKUe2mDt24KXr/Td9WzK3sR7rq9S2GwE/Cvv906IQgRgVgBnbIezb753zzI8uPW3oOvPnY9WPeWEbIz0+t+DHnppFdgqfeGPtETljPaQkwuVWnaJuibjqyiIFalgNRrcMTASMEy2pTF7KRUTJiJB6aIeR4Acmwo4nh1Bo+JIxPMJvCbmrVv/2dX64hi7478KOaQoX2d0J+dXcSzIj4a9z6f0xMzeiiGYNq5RaEnWbIyo2cEaCxxRbXzhKd3Ea2JluTWQ7GQazIYrIqhAMFJu28oQtghIJZVpWkOkuwACZE3VgFEH2TIjAumXFaEGQHtxDweE4OwKEO2/PihHW39H5id/mdB735FRgLfwk73TlznV2q3MbUfxgyHIIYRzkYmUWKCUBGSoUsZtVDkag2YjGjMExgmlowqJskkBiQ5GwEtBOI3RPMQgxkUEgcm2VLTmQiw1E0p4Q7hrQtGPjJ0mez3/v771eWzN+qfmDZusvm0eDw25MhSorC+ndXty71f9r/IbYDJhCqini1mnMwiIM8QkyIKsiiOuIZUYKCWvXBAKT1mIu56goYOINS5NgXnRC2yxielRUsr4qN6Rx1X+/xG/655lUvvmxDwH+P8pgx75bAOKBtX9qEYxFmAYIxvHbYYVxqG1eV54ISQEBgRAZw/9LKPCaeU4tBcyqGzhYhsjm6W16fu3L6Thnr6E22L7rpLXLq8WnX+BNs/fnslX+/nHcvgJXO1E0HOMwMEwYTMRPAQIt2YhfEQBMbou4eQwEWXIjlGDZfLSQi02Jf6dZs+NypU7Z9dv/cfYduV6uH4oJr4WYYT/CnMJWpN2j1nnbWHWAHdlhheyA7QBt1uzJrXSH5fC5nw2YhPK69WVSu62hteY/tQ0IOXHBHY2VvbFnDKMp9x8/CSGEawrzIuVjEMLYXW0dyqTHprcPSk6NHpg+5Mb/7pvjXvypa2Href4u/euXgx+TwG8e/aWh1uM74Wxgh6wVeDgt0hIVj5Pr0t1nHflhZuv5PQuZqF50tPqqdGSbFnn/cNY//hZFZmBMciiSFKSjW71eBNXhqQRh5SwEQ2SIswRI2pf/rtOexKZdSG8JI2TwW8IKsIAAs0S3q+Sndek6tCCPkRE8IBDkoIJVl5emeB6dcQi0JI2SioJhxpmyxYPi859EpF1Nrwsh8JDvlUIvEQ8Y25YUfPP8EyvnUnjDyLy4IchwUnAIAgjWHFh9eUYvCyNowDNjQHLPCImgWHYWefwjlHLUpjJDCcGznJUGxKEo8H2nkSyvqjNoVRipaQ97kEM3RIm+C1rHP0/1iTallYYQ8wAIOcIrM8RCglvHv0s2sZtS6MFL6KGtmAMdziU6GQVzgsrobz8OI1L4wQrb3Tges1RHNuiSEOS6Tdn3UgLoQprKUleIlk0ttTAfKYsMalcrP1JEwsopDyIx5KZ2VMWO6/9ReeizzjLoSRv5IQxBwQVjiOO2y0A4Zbq7jplRTZ8IIOdjFAhjWwouNBAAZDuf/n7eRriXqUJjKnkyALGHhKIR1sCYuul7c9V3PqVthhPRnxUBFlAKw4nCYpB99inVNUNfCyqewANiALFoVjAAaSq8huAo1ETa1ahjaFxISV1Qv9FEYIUUzBcgBDttkWYAMIzd7Xm1Jn/6Jdg1fnhoI+0yqvMV8f0zh/qjqDcFnYYQcaGOHAECT7OJYFkCI0wa2Htl1FO0BuRyeCyvKmFgp7NlxhAxYeW6xDsK058dk2DlJksIFwcVrV52i6Jz0yToEbnh4LmzQ2pmVwqaptdykqicm/rBo0aLR8brkUTrDzlubCYpoxgovAgy5TNzn62Pky0FdZ57U5RMaCB4Le/0OUiXswTmE3Ft1NNvx5ptvzuyhUyYvOQDgkCTzgo0TU1mEEA51hQauOflSL9oLUo3HwrpHJbpc96szi+4iZHB11bFVvyHbPg+H2lOYkGDCvGRHHGZYZOZdBZ1otV9NTapEdQur2FexL+7EkajqARN0FEbI79MyObXqkBQIOdQIhWAGYk6Reun4EUanhsKKmCLyfHrz88p6XYWplN/kYLUxQaEQwCWwkqANOonqbDDa+ofPDWe9hanl6MZnk3gFOpHEyiLLmpEJMs20IZBoo5rUS2EaBzo0hWrZAW1ALQ28A5cAAAx7SURBVBvjwxAD4ydndM962x+fZSzqqTBCds0I5NVCUYFAdEmBAgAMtHdOp+VHvRWmsu+T/hE2HihyoFUQoA0jDsL4EXlp7V6/hjtB6rOwSiraI06SAgRZkpyQRxBgnBiSf8K/H1qPqffCCJmuHsvYABtyYQUjRgJ5ECBl5dXf1zAxgDDyUxgLtMefQGSReVFtUccL2pMbIlo/sMvvn13vMIIwUv5ZR67yYayKKRqbRRuGJqCNJMGJPV661k7DGEKYxoH5vU0YSAhigGUcLEiYd0HE8EKX2R07PV1Oyv+onTzqGsMIU1mY7cAW7alDbCNZspgsJhYHsFbA5XbPGn53et/MZbWWSR1iJGGkZPtT2a36hUvqEU1SsAVb7WGQYyDvZIEYO6Oke3UrbefrHzbQkVgMJayK0pWRJiQzLMOymLOJCPNAhMBq6jqzz63D3/iLkJNkfsaYe9s0zKObAYWpvN5WFhFkADLLkA2WcTKwxmAEEQ4KaT01LDpWnPZozmN31kFi/seYwlRKTmzPcbGAgS1ZyMPGdlYbA122iyL7ycc8GzjpUHa7uknMzxhWmMano6PCJTuEMgi2AYRkqzkkAIDgYCwkShZb6Mi3tJXKP3qyIY0EZ2hhhLyfZbbGYpZFAEdxLqtLAABrD1dBBSyD4rreQ8iJnLDmEbG/1WWSumJwYYT8fl+HwTlBIicBVwAHMYttSHRiiQeSrMj8P17pqAzsflv74JiUeQ3j9lzDC6viwFQlwo4AAHwejwF0SRAntgI2ACADBx2fokhvz00aXddJ6kIDEUbIkVGRQY1NWGiaJoq4KQaOdrJThNr4wRynMGyyI9C1va5z1IMGI6ySnRGxgguY2nWHXBC0ysBl5QQRY0Y9sKULkO/QAM7KNCxh5MitTWJyEsKSn3PFY4hlh12WXdoYcnE2KPAA8hMfHHL/4bpO0icamLBzvFwwSS1DOGhOFAC2NOYxhtYAXm1rYx5nbqnr7HygoQoje5e+2hZK6tYlSWzsBxKCka0VESAg2TADuZRvtXWOzxz20JGq1T+f9rgxuvsbrDCNL/MykmMDolmHVWaQzAUgiyJLHMdCkQVJI/IckBeTmx0iFR8/f/uIdUszt9V1vp7QoIWd4VifyCZ9nBAhs5k1iyZeDsYs1J4xwrOhitJsY1xiopgx8fZ/9a7rRD3hWhBWyd7xEsCIRQJgZYdkYjFGohDGSaw2Ko/IsyHNJll213WSHnDNCCOkZIgoS2qJz5okrEiSuqWxiiJjwIDRJiAKZoYR0zedWffvOs3UHdeQMEJWtYnv9O9gdXeIEGeSHDwLObV4VFgZc9qFB+1ZPmTBl2TnmFS709qioM/aus73clxTwio58sJN0Qgo6q4RAoYRYhQH5ngrZJErSVAPbHxYUIIpLMiFHSM7L6/rXC/DtSdM451UrF3s6AgVuTQbDAWARQ6WtWj7SVh5OZb2fMCkpNCqOwkr/vN0/Rnz5doUpnJ4Z6l6qBqHYbgVM+Zu4RjLybxJ4VjMQTYICVGRiENN/vHOZ4Wnu/3jjTtuveDNdXi9yDUr7AyHWpmUwIHWgYMU7V54NlZRy34LK7E8L3MQaaW/2WRpOmnDzW8Xk6PvrysmJ0+Szc0bt3ywrm7jvdaFEVJeTsiOkX0XH5/GOWXWxPJYtDIQATML7BK2qc7UxgAnK227ZA3KDi/ITU0zTX22/cAnz75///ihi2rxVBsVVs36QJZhcIQVsbwEEUYBotXOcSIrIgVgjAFAVgE0n2Fmv3+ro+R4pXK/uK0NimjbsvPp/35YS4/RosLO5+SX0ZxqinUERLkAb06TJE7iA6DacNOezAkCOQ5Ci2qOV2TFbO/0KfkpjS/oYflnm5SC5MBHayVFKuwivn/pjV/VH0VfJvKsWviLIie4EMZmh8DyggwFADgOsIKVVVoliOEhoRHvkIlNHXEDPv3B/lZt5EeFXZFn4rFWiABO3bi4EBwgCbKETZJgkiDEJps2QgWEDA7uPNsOpIfTw0JCf62FrKgwd2ycmxdgRiyGNoCRzc4gtZZEZsWEZJcFQTgfApZTJLUu4XCcKKCk97U3lY+LMId3+m9VhLJSsk/X89xU2FU4vZ+Q3X0FnlMPY5CxR5ih3N/GQhO0oVDM2VgkMhBGAA73lhUOt3j6dGmTpuGNI9Oydu4rJUVD89OdbZP66niLLxXmEYee6pKS0ntugVIQaoG82rhWBODEyBwQa4fQlPi6U91rcmbIanexAdYazALAmGPndm7V0hIa/Hhmxpc/6NVuo8JqxHPNUjpN+efLn7Q03+qSkbqfNH/CcgG3ZzVGAoizScACMMNAweZAHI/UpncjGYtyziP8wFs7XPbejN0batoaoMK84mRqREez2lazB3MozBE0RhuhwsnDaIkPwqJJba+xQqLWLSk04uzmkbwSO3ntLc+NnVNUWt2ptef+0S8P6/uP/EUXBC7/cYv7fi8qzEveGTnt114PT74uYfeNMkbNCrAZiMFR2MQGSmqbjRFFF2+GamvbFRyrlpIB/eL5Hp8/YstNDMyeUPjzoiV//dzikTVtrW3yZnT6pSrgLxuOEbI/f+S4bLfXCFFhPlD20pjZ6p6u4pWCtNs+ubm3gBASBCFZhIBTm9yKwDdGUFYPalg0q8c0DNRmAsTQCdW1eCmwo8Box0IuWdukTvUeOiVvOen3+U8lB/LcfSYVpheT+zUN0G55YlkUIPBqKw3AKCeUoVUtJNOQojYObIzAmDkEGGTSGnCMwAKE+znFDFJSOLpJdsGatvtsrhBzStbLd0yqvCDo982XDq9FhenGz8vmT516fazQaFT2JrLzLgvmcyJZyPFWa89ADFGohHnBjFwSEmQQq3VQsiHA6pQ5EwxtZWeEwOi4GwRoNdlNwPbsf9p/Rr4LNcU0f+XiT6HC9Kbs642ntJ9/Xo+hnJScEG1KSbRi0MrBshIMFnlB4HhJkoMQK2ARYeRgsXai22qOdjBA5EMC1UZ6TO7yju+K+YPMSvjzX1/YIKDC/MfJSVltp/38WPNQKwAuczDAZqzuChUYBmWEAtUjHu9kIBuuQAHCUNSJZQDK4zCL4oO5lghBLi5/oIBcHbIu2C9SYX5n25QRDwbIEAgAQpZBwKTdnY1t6sEM8+qxjjXLsmiyqCvACGwWRBHZFO2mG7UpHt9MPSiarUHnX8NFhdUKZevfeX7Y8Oy8rIWTQywpnYMDRcQpseGN2zXh5LCmiiLa1GLSlu80Y0Y1hBEWMOKARUSSDYfiyPO6tqiwWmfd1HmHzsyWlZEeLAxRSxIAGVuM0oiHIrBZRBvLB4eprQMGJlliUjKC/ln9biqsrlmhVSNsaFxSYlCAAHpV9I1pwiHB2SrBamGghcvoYxmRl129OhVW96wYNXrpDxXzm0Q5gr4n5HDaBFeapG5xjsEcKoBcaEhG64LqlamwesMf66pOgO4dlx9sVlDG8PDorMBUgFJajzvvwWpUWL2k/OSX3VpNLKxY9685OZnZk8qr/wsVVu8pvqDlTIUZDCrMYFBhBoMKMxhUmMGgwgwGFWYwqDCDQYUZDCrMYPgsbF+r9GpitYcx+4jI+h5Dwg0oBpd03m84/fJjhddA2AV8PM3LN57H7pt8j3GFv8Paj9FVhztXxm69+jpUmE4xqDAPocI8Y/10L994HvuG+x6DdKonMa475XuM8R4MC+itsAo9xj8ooTFqHMNbYZQ6ggozGFSYwaDCDAYVZjCoMINBhRkMKsxgeCnshYTEFT586olx52J4G2l2YugEX2NU3BEd8aSvQQiZOt/XGJEmk2mHZzG8E7Y/pnB/1KW3UXvK6m4FZ2N4G2l94+OFqSt9i0HeKSj7w7LPxyDkM2mmj1+mNFqbehbDO2HPqlvIgJVevVVj8d0FZ2N4G2m5umXcM8+3GOTzdYQ02eFjkKKMiTN9/DI7Kod/8CyGd8KmzSZk0kKv3lrJ5oKzMXyItLPRzz7HeC77Tl8TGbR25kwfY3wU2TR4iocxvBP24BxC7p3v1Vsr0YRVxfA6UsWC2HW+xiDktxcTdvgW5PU7iCrMtxhbF1ccTF7lWQzvhC26i5DBPlQdmrCqGN5GKu87sNDXGGT1t4QMf8a3IN2jEl2u+338MhWE3PewZzG8E7Yv7sSRqGNevbUSTVhVDG8jLb2uOg+vs1l4fXFhwnofgxBtC/Mtxqz+ZX+mrvMshpdl/fPpzX0p6zVhZ2J4GWmM7HQ6F/gWg5y+JSZqpo+JkEphvsUovj0ueq6HMf4fcCOQzmmXT/8AAAAASUVORK5CYII=" title="plot of chunk unnamed-chunk-20" alt="plot of chunk unnamed-chunk-20" style="display: block; margin: auto;" /></p>

<p>We observe that the fully trained model is overfitting as the validation loss and training loss diverge. The validation loss begins to increase with each epoch; we want to try our best to increase the number of epochs before this occurs and see if we can get a lower valdiation loss overall. </p>

<p>There are a number of strategies for dealing with overfitting:</p>

<ul>
<li>Use more data (easier said than done!)</li>
<li>Use a less complex architecture. If we had stuck with our original model, then it would take much longer for the model to begin overfitting!</li>
<li>Weight regularisation - We can apply L1 or L2 penalties to the layer weights, see the argument &quot;kernel_regularizer&rdquo; in <code>`r
help(layer_dense)`</code></li>
<li>Or dropout</li>
</ul>

<p>Dropout involves randomly &ldquo;dropping out&rdquo; a fraction of output features from a layer; this means we randomly set a proportion of the outputs to zero during training. Let&#39;s train the same model again, but with a 30% dropout rate applied to the first two layers.</p>

<pre><code class="r">hidden.lay &lt;- input.lay %&gt;%
      layer_dense(units=128,activation = &#39;relu&#39;, name = &#39;hidden_1&#39;) %&gt;%
      layer_dropout(0.3) %&gt;%
        layer_dense(units=64,activation = &#39;relu&#39;, name = &#39;hidden_2&#39;) %&gt;%
        layer_dropout(0.3) %&gt;%
           layer_dense(units=16,activation = &#39;relu&#39;, name = &#39;hidden_3&#39;) %&gt;%
            layer_dense(units=16,activation = &#39;relu&#39;, name = &#39;hidden_4&#39;) 

output.lay &lt;- hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;linear&#39;, name = &#39;output&#39;) 
model &lt;- keras_model(
    inputs = c(input.lay), 
    outputs = c(output.lay)
  )
model %&gt;% compile(
  optimizer=&quot;adam&quot;,
  loss = &quot;mean_squared_error&quot;
)

  history &lt;- model %&gt;% fit(
    x=X_train, y=Y_train,
    epochs = 500, batch_size = 200,
    validation_data = list(X_valid,Y_valid)
  )
plot(history)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-21" alt="plot of chunk unnamed-chunk-21" style="display: block; margin: auto;" /></p>

<p>Whilst training is taking a bit longer now, we observe much less overfitting. Using droupout has allowed us to train a much better predictive model. </p>

<h2>Checkpointing and early-stopping</h2>

<p>Even with the above techniques, overfitting is inevitable if training continues indefinitely. By default, Keras does not save the model at every epoch during training, it only saves the final state. In this way, it is not guaranteed that the best fitting model (in terms of the validation loss) will be returned at the end of training (unless the optimal number of epochs is known a priori). To overcome this, we can use either model checkpoints or early stopping.</p>

<p>Here we will use checkpoints to save the current state of the model at each epoch during training, but only if the validation loss has decreased (to save storage and computational time).</p>

<pre><code class="r">#Here I&#39;m just resetting the model to it&#39;s pre-trained state
hidden.lay &lt;- input.lay %&gt;%
      layer_dense(units=12,activation = &#39;relu&#39;, name = &#39;hidden_1&#39;) %&gt;%
        layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;hidden_2&#39;) %&gt;%
          layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;hidden_3&#39;) 

output.lay &lt;- hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;linear&#39;, name = &#39;output&#39;) 

model &lt;- keras_model(
    inputs = c(input.lay), 
    outputs = c(output.lay)
  )

model %&gt;% compile(
  optimizer=&quot;adam&quot;,
  loss = &quot;mean_squared_error&quot;
)

checkpoint &lt;- callback_model_checkpoint(filepath = &quot;model_weights&quot;, 
                                        monitor = &quot;val_loss&quot;, verbose = 0,
                                        save_best_only = TRUE, 
                                        save_weights_only = TRUE, 
                                        mode = &quot;min&quot;,
                                        save_freq = &quot;epoch&quot;) 
#We will save only the weights of the model, not the entire model itself
  history &lt;- model %&gt;% fit(
    x=X_train, y=Y_train,
    epochs = 500, batch_size = 200,
    callback=checkpoint,
    validation_data = list(X_valid,Y_valid)
  )
plot(history)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAGwCAMAAAD/kMAYAAADAFBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7////isF19AAAACXBIWXMAAAsSAAALEgHS3X78AAAgAElEQVR4nO2dB2ATZfvAk0tuZDTdg5ZuoC0tFAp0Uyi0lCF7VvgA+WQqKEsQAUVQy78MBRfIcoCiogwRP9luUUGqbHEAsmSUVVra5v2/74UubK6Xy13a0OenhnDmHh7y6/O+z3u5u6gQ4FSoajsBwDZAmJMBwpwMEOZkgDAnA4Q5GSDMyQBhTgYIczJAmJMBwpwMEOZkgDAnA4Q5GSDMyQBhTgYIczJAmJMBwpwMEOZk2CDsTHwrQAQmvTzE2issb7z419Zn2ssUx63arSBMdkCYkwHCnAwQ5mSAMCcDhDkZIMzJAGFOBghzMuqosNtmu7K5j6kQZr5dsfXnFrbGkVXYkU6dU6aW2JpC/aBMWMnklC6dj5RtrV1hxal/ILRovq0p1A/KhL3wIkK/ty2++zsi7IMmXn3+QSWjvbxm3X0UQk5h/NOSjuL3rU+UCetIRqDxv9z9HRb2m/u+olEPog9aXvnDdMzyKBRHfmEZ4vetT1QR9mglYQv+i9AF1rw75ItShCyPQsg7JP6O0IJc8fvWJ8qEzV+I0Mm2ZRM9FjZlDv6Vu2SeF+Y+vsjyKBRH3qajS1bqtBp+Quor5U3H1NSsruWDHqmwhxG6xJSeOoeOtHjf8igUR+a2vhDaeitUausLK7ZiYcc9DhSPHYByM/++0nqN5VEoDiycHUT1C2fSJa5v4t37Irrew+QzttjyKBQHhDmIOnqkA7AGCHMyQJiTAcKcDBDmZIgQVnEkWOCYMAhzEGXCnr+GH5afrO4lIKwuUSZsb8Y1tPihssNBHVcj9EI2einEJeHoPcKsHMQHYQ6ifEjcm/FCuS/0cl+EEjf9yf1SOGZ0VWHWDuKDMAdRMYeN979a/vyMqeicR1HRBXR5/KCqwqwdxAdhDqJc2OsP7c64Vr65zfblI1Dx5MA26fcIs3YQX15ht5aMf+221ZfWa8qELRleij7vcKNs8/OPd92O1sVdQm/dW2FWDuLLKuxm2pq85R0Lrb+4HlMm7GMytn19rmzz4aCgErS0w5381D5VhVk7iC+rsNdX4oeX3ha/cz3C2jos4lGE8jN8U9f6fVS1S7RyEF9OYSdSfkDoXPZs8TvXI+rkkY7uHdD5lEcEPzCtt4gSdmQMz2SBl8gqrCgsMWZsdzgxsTrqZIWhM57NN8A5HdVSJ4WdT9k3a5KdCd2v1EVhl5J/QmjGDHtTuj+pi8Ku8Ee7vrMvofuVuigMEACEORkgzMkIHiUPIMxBHPlRHpKqjS5d2PVzVl4HyEP1Q6tUYQUPds5OO2hfRoAg8gqb/AFCf6fAsQ4FkVcYH230UXsSAoSRV1gHcrXRsD/tyggQRFZh1+bPM6Pv0u1MCRBCVmErxzyb1i7sVTtTAoSQd0hc8HDx8JfsSwgQRl5hKLfJi3alA9SEvMJKh/d6GJp6RZFVWCkeDxeAMUWRVdhiMn/lvG5fRoAgMs9h1ya37/imXQkBwogXtrdNw3n8k9URkR9VbK4qrNdGVDhupWzZAf9CtLBroacLYn7HT86GXTkbUn5ueFVhZwfih2K4PZiCiBb29hiECsnZwismIJS9sXx7FWGHxlmPCciCaGHz+jRrOJEcKpyTi9A0y9GM4itXrnz1aKUXFSddQ2j3aPnTBMoQLeypJhfyW5G56+kFCD2xlN+2rX///ikhlV+1N2Xqf7Ou/ntvQC5EC1uCK+lJ0nUsm4jQkIquY0Pl70daVHh739G3zsibIlAZ0cJONj5/udnn5jPmM41vXQqpuISwirAPut1Gy7IFb24F2If4tn5FeMhzKF+Vj1a1almpra8iDBt7GXwpit0L56rC0ANsWvut9iQECCOzsLl+q7pd7PKLtRcDdiOvsJfbfIzWd//sWftyAgSQV9hbz29DaOvmmfblBAgg85C4v28xKhn8tV0pAULI3XS8mTg4aZk9CQHCyC0Mlf4N1zgribzCTj9auio9qelF+3ICBJC5wpYljT6dvKwTnCWgGHIPidE9k35EIwW/7gWwB7mFpYRnlaCp++xJCRBCZmHnA3KXZV9Nhju6KYa8wi4nf9t7UFvfPfblBAggr7Bbf6DTWYmtH4E78CmG7OuwzAMIrZ5qR0aAIDILe2PKQIRyF8FpOIohd4VNiEILHy4FYYoh+5AYEv9w0bqJdmQECCK7sJl6zt13tfSEAGHkFrZwYMfHpxQNgA9YlEJmYW+Peu1dNOnVfdAmKoXMwm4uXrweoVWbhO5aC9iD3EPiZ8kdz2RHd/jCnpwAAWRvOj6L4tybdnjCjpQAIWQXhqI9TyPU65T0lAAhZBe2wueTjtfR8/+zIydAALmFLes99NDW1D39/rAjJ0AAuYWtSdga2zTSGHzBnqQA68g+JJ5Katk77KPvHrQjJ0AA+ZuOPJe0ArhsVjHkF/auZ0IeQu0kZwQIIruwxRkDn/eOCxthR06AAHIL+6dz4oGAGGZgB7jkSBnkHxJ/jpiZtRl9P0V6ToAA8gtDT+rXIPT7cMkpAULIL+xWSmzSzl2zV0tOCRBCdmG3Gi5Y6G5w9V5jR1KAdWQXtvG91NGvJncvzThrR1aAVRSYwy66Zy1FaNEmyTkBAiggrCQ4+DuEpn0jOSdAAPmFXU16vFObJT3a35GeFGAd+YWNazfvdXdNQPwh6UkB1pFf2Hnz+NDhzxT81Vl6UoB1FJjD0HWXDPzYES5OVwIFhN0ZEzphDipsKzknQAD5hZV2avXkM2MzknOkJwVYR35hN9a9MeAxPd0IhCmCEnMYWmgcXGqe+L7ElAAhFBE2PGxAMTo9RGJKgBBKCHuy44tvDDz78zCJKQFCKCBsS6txqRdzAgZskZwUYB0FhBWbZ2enmZrAF78pgiJzGJqoT5vUdp20jABBFBF2LixxIirpBBdEKIASwv5umXlx9sSjr70nNSnAOkoImxzf9RjKTnhum9SkAOsoMiTeTEj+IPPb1JsScwIEUKbpuNnYlDLoT2kZAYIoI+zTVJ/4B3qck5YSIIQiwj7N7Lej8/Z9fSTmBAighLDCzOkd0bXMGVlwFz75UWZInBGEvky7nAnfcyQ/yghDLdqmXf7kP5IyAgRRSNjnxoD2D+dLyggQRBlhX6ad6xQ18TdpKQFCKCLsx9b/9Fg2bmj8YYlJAdZRRNjVJd0eRWdabRopMSnAOgrNYWNa/ZGUV5glKSVACIWEnYjxOoC2TpeUEiCEQsJOBzZLntsO2kT5UUbY6aS8vP+Q+6sAcqOMsGenmdekNAncKy0nQACFhsQ5vYfcmf5Y2nlJOQECKCQMJQ14agpaBufhyI5SwkYmxprRyrekpAQIoZSw/i1yRt/ocFpKSoAQCgmbPn1BUlSDzySlBAihjLDSmWtR6eHZ86XlBAigUIWVPJjbubt3m+OScgIEEC8s2Gg0nqzyhMfKHFYSPC4p72Sm/QkCVREtrDj03icWrAhDiV6zEOp9xY7UgOoQLexk2r1PLFgRdtr084Ovoy5wdEpuRAvbEdy8wYwqTyxUL+xs0oglRf0nwEWYsiNaWN5y8/noTZWfILQlIyOjeXB1Af6Y8tXsdu3iPpQrTaAM0cJKzXh1Na/yEwtWhsSLqd9dm94FznOTHdHC5g8quRy7y3zGbHlSvt1a03ExKihqaC/4ynS5ES2scFzj0IUoX5VveVKONWGXG3l9jd6fJUOKQGWUOpaIpsScTf3uDizE5EYpYW91Go8upOyB6yHkRilhB8el70THwz6WkhMggGJD4tb2Y9ICRkvICBBEMWFoa8aDz9meD1ADygkraaLrnbTB9owAQRQTVpKZtDXzUhf4gEVmFBM2NP0A2th53asScgIEUK7peOQHhL6dv1xCToAAign7PaZrAZoRBLcvkhnlmo4jjePDA+DcX7lRThg6EpRttjkfoAYUFPZ8hEtSNpysLTPKCZvf4rUjiR92sz0lQAjFhB2YjEP/MqHvJQlJAdZRrsLeT8QP+9PhhlPyopywQ74r0E8t4Qs9ZEbBpmO/V5xHe7hXh8woKAx9ZNxuazpATShZYUkTPQb+aHNGgCDKCfsxuc/LX8emfWF7ToAAygnb/GM2Qoc/6Wl7ToAACg6JI8h9VRak2JoRIIiCwtZ43kIzH4T7TcmLkl3iWJ+uqalwMFFelBSGOnt/XGRjPkANKCls1sTJkR+W2poRIIiCwmZOynphRkQPMCYrCgrbsOJlhLbPgjPdZEVBYaf77kfozlPP2JwTIICCwm5FTUR3+j/4js05AQIo2XRccH/8gf92gK+HkJWahBXVdOquUFt/ztT8ZbgGU14Eha3tXtzEp4b7DwkIKxm8MHpEntTMgGoRFNY6b/Ooq0HCAawLKxn8XPKKuKTXJOcGVIOgsCYl49cXegkHsC7s5Pqef6FbL6XAoCgngsJG9fC/Mi5dOIDAkLiRnIZzuCcMinIiKOzmG0fRnBpOexIQdsztJ3QoMfm61NyAalC0S1xnWtT8oZkSsgKsomSXiNAKps8n0vICrKBgl4jQ0da9TUkrJGYGVIuCXSKevzpsO5Yw9A2puQHVoGSX+Om3QxA6/nmG1NyAalCyS0TpAxG6npEkMTWgOgSF3c7J6PB8DeteIWF/u+y62WnuIxJTA6pDeEjs+t6H3cYIBxDsEje7+HV44Jq0zIBqERQWeAeh4hDhAILCbqY1nHxAWmJA9QgKC72E0JVw4QBCwm526pwd3nMEXOksI4LCFoZNnRaeKxxASFiPOdPR2eSJcFaHjAgfmto948mdNQQQEvbPpD24zDZMk5QZUC2Knkh6IWw+QivbLrExJ0AA68IyyhAOINh0HHRZsyw9Ca5LlxHrwr4qQziAoDC0z9Wt1yGpuQHVoOiQiNAST78J7TbZlBEgiLLCVobv+DPxQMot23ICBFBU2F9ZCQid7D/gexuTAqyjbIUdc/sVnUrs/odNKQFCKDyHveL5aWJub5syAgRRWBjKoTzjv7QlIUAYhYWdCujTYnOXbTalBAihrLBTCfHoWGIefOYsH8oK+2ToMISOjk2wKSVACIWHxN2mC2jRgO42pQQIoXTTMcsjq0kzODglH0oLQxHMkNH9S2zICBBEaWFjo/ekXc5905aUACEUFvZC061oZ/rSR23KCRBAYWEfxDyC0MisHJtyAgRQeki86P70rO5JcMMp2VC86fiDYyLiv7MhI0AQxYV1ScvafBk+EZMNpYVN9C+6mfX+QzWcZwCIRmFhF0a5/4nOB/f/waakAOsoPiQ+7X+844tpd2xICRBCcWFouNrFtxtcECEXigu76flk8tnP4M6/cqG0sJsJSWh/8oFUW3ICBFBa2Ef9miD0cRhchSkXys9hTQb9Hj9vqviAgCDihQUbjcaT5MnqiMiPKjbXKOwff7VnAHzJvVyIFlYcevfJ2bArZ0NulG+vUdge95FPmMdvlpYecC+ihZ1Mu/tkxQSEsjeWb69JWJ57Lnpy0tAarpQGxCJa2I7g5g1mkCdzchGaVvGN9TUJm9QztbQgfOpj0lMEKiNaWN5y8/loch3K0wsQemIpv21LRkZG8xpubYTOhQ9ImdEdDibKhGhhpWaEps/DT5ZNRGhIRddR4xyGPtewoc1XS00QqIpoYfMHlVyO3WU+Yz7T+NalkIpDTTUKK2g0dfGI4gz4tll5EC2scFzj0IUoX5WPVrVqaUNbX9TKvxAt7Nxlix1JAhUovnAu+DpiCtoW9+g+G5ICrKP8kQ70RXBG6MDkYvEhAQEcIAwN0vgN6ggrZ3lwgLBnXC8/OvebePEhAQGUF/ZFtF+RuU94W/geMVlQXtjlgiZdv0n+up34kIAAjpjD1jahm/q9JD4kIIADhJW+Z0yN/CzxoPiYgHUcIOwbQzZ6v03SePExAes4QNiLCyJ3fNp8ywDxMQHrOGIOO9ateatrr8FN+GTBEcLQaD3n6Qf3L5IFRwh7s+ng9+Pfa3FVfFDAKg4QVtDV8wd0KWggHK+XA4cMiV1b/TbklcUba34hUCMOEbZ2hNeIT1LhTrJy4BBhJRGszj8GVs5y4AhhJekRp75PXAena8uBI4TtGOtVgN4P6lAgPipgDYcMiSgm89ukv9PgKz1kwDHC5mSZ3p4wW3xQwCqOEbbfx6BrPQium5UBhwg7EJVWsjXziQXiowLWcIiwpbHDEXoy4QHxUQFrOGZI3B75zoauh4eJjwpYwzHCCts2bbqlyxfiowLWcIww9IaR8YmFr+CWAccIWxE5r6jXW22Piw8LWMExxxIHeH2NCpoMXiU+LGAFBw2JQ5ufGJOz6GPxYQErOEjYD2ne4/6Xel18WMAKDhJmztLRgYknxIcFrOAYYeYxzfcdS9zVSXxYwAqOEfZVRhRCh+IS4KZuduOgIbHEd4157AudCsXHBarHQcLQ1Nap414ZKj4sYAVHCSsM17hH9oYKsxtHdYnDQwsefP2dZ8XHBarHQcJmNp6F7vTJ6Cg+LlA9DhJWuKLhpcIer/QVHxeoHkfNYcVxMbG9234qPi5QPY4Sho4xdOyAQXDilL04rEuMGftV20vTPhcfGKgWRwlrG3oC7W3TY5H4wEC1OErY0Q490M/NHoNLjuzFYXPYlQAflygv+MzZXhwmDPU1NF3+K3wFt704TNgW08mZky93uyg+MlAdjhL2RxP3olvZ/u3hQmc7cZSwK+d6hrRp2KwBfFWfnThuDrvsro39z5vTxEcGqsNxwrYFPd39dmkH8ZGB6nBcW+/ZuWhc46RM8ZGB6nCYsBdXusYsjvBpXSI+NFANjhsS0eMmz+j1z20QHxqoBgcKezQ+9NnnX50rPjRQDY4Tdjysd2zE24EjxIcGqsFxwno3Ny5cpY9JuS0+NvBvHCfsWKHn8AaRM4f+Kj428G8cOIehDEPsT/9zhS+msgsHCssJMSY/F9e1h/jYwL9xnLDb3RMS+2ndUqPFxwb+jeOE/b4138dn7MrDDeCubvbgyDlsYpixfVM2+SnxwYF/4UhhI0x9vcOfzG0M57rZgQOFvTJxDZ3tE+UVe1J8dOBeHCjs+qk1JqpFmyGtpouPDtyLI4fEkqigZs29I91biI8O3IsjhY2f2t2Vdoud7XZEfHjgHhwp7NvNXbWtEgJS3OFKTOk4UhgqaOnDmqIDe3nfEL8PUBVHCivokjmZ8ms9MDPgBfHxgao4Utj5XYc83LQeuhjfIPHxgao4dEgs6vlEKKPfmuzlAl/rIRWHCntjRXI7jScT/FyDIPjOWYk4VBgqSQ/MokLDG/Q3rLNhL6ASjhU2am6rAA3jHRXs62fDXkAlHCvsBEpzc6VcPEI8uBwbdgMqcKwwtKxbtJ7y8m/UyGi4YMt+QBm2CJu9lP8l2Gg0Vhxwt0nYuUcP+kdxmoQ2jUL1iTbsB5Rjg7Av9PwwVhxaZattFXYqaXSsl4Z2nRTsz3xiy47AXcQLy0+cwgs7mVZls23Cdv/ar8FQTuPOdXXVG+HiPgmIFzZ4Ww4vbEdw8wYzKjbbJgw9M7WfR6pG69cgyYOBj1kkIFrYukeQRVjecvP56E38ti0ZGRlxMTb9eT8UxfuG+9O0d1BDb2qSjckCNgh7ICTS23smflJqRmj6vPLteeNt+vPu9F7ZwBCpp7lg7wAXaqlN+wLIti4RV5j5jHn+oJLLsbvKN9oo7MZn76b6cYlaF9+AVl6cBm5lZCs2CstX5ReOaxy6sGKjjcLQp/3e0zdgB1NcgCnandHAids2YvfC2VZht75o25cJ8Bio9mgQ5uHJaH+0bfd6j8OFoVe+S4hkfWLbqw2uvr5uDAXLMZtwvLBbycfDTUzj4YGUKcDH10WrfsnGAPUbxwtD17u8qXc1TGjbQOvm5msyaNUd4MMx8dSCsL3vpU/V6j22J7pTLh6mYA8d5XvT1hj1l1oQhiZuH96Q8ohe2K2hxujl62o0UOwhm4PUV2pDmHn43DgdFdotZ0ITinN39fBhKHU2XCEhjtoQVrw66XN/SjNoWKdXuqgZQ6CrmxujNsC1z6KoDWHo+K6kRQa1sdNTHZ7NVVN6vauL3kCp+0HvIYJaEYYWLOqWQ6tbtk/7YO8hRqN383I3crRaCw1+zdSOMPP4/xuWrFbHr09c8OkVb4oxmvA/LKWiZ0sIVr+oHWHoh4ezZgWpmMRZzaceR33VapYzuOv1WBnV+pSUePWHWhKGXpjdPi1V5Ro7ofN/fkB/uaoZo9HTXcexGrWKfQTu+Gad2hKGxqWsTwxV+XXp26vzVoT6qykWNx+uBpalKbU69KUiaVHvf2pN2NnNiXNjfVX+vTvEj9mA0B+BaorjOIPJyHEarUpFRR2VFvd+p9aEoQ9nx07o4qIyxo/MSn8Bd/Tb3FVqLcvqTHqDQcdpsDPvp+Eb/f5F7QlD82fh8dCk4rLate8wIh9vONBQraa0Op1RZzAyLI2nM5XGe/g+qfHvT2pRGFrZp3+HhBCVOjojqfeElaTTKBhM48pidS46vZHTMawGz2cqtaEnfD1BObUpDG3pHD+yc5BK5d6/f2iXeWcs8ZrgMqNphjMajDodp9fSNK40tdYUD+d/EGpVGNo1qlta+2Zk5MuMa5bwmuXM0luj3NUqCk9nnF6nx/8yHE1TuNawNf/Bf9rxp90X1K4wtLtnemZSR+yCDoxtEd+j7JKWktEcmcAYjmGxMYOe07toOYbS4AFSRXG+aYvr721Na1kYOjskaeDQENzHq9nwuMbZGdt33P0fpa8EUXgrpcWjIx4ZsTXWwDKk1tQEivGMHTg599t696lMbQtDN14YFpYZZ1KReaphZF+vp/pdKZdweVaYFlcfpeE4RqdjyaSmw88YRktW12QXtZp2bZw+YfN1VFBP1NW6MIRyH4qLbRGiIW+/RhPpNiA8o9eBiv97a20ckYa10QzL6VgjZ9Dr8K86mtOyWi2pNxWBoli/lh2fPvi/3ff34q0OCEMnJzaPS0p0wVLUlFrDeHHdmg4f9djJipK5/fGwZixFhFIsraexLTy1GVgXPFbqOBbPdFqNliLLNjVfdFrXoITOA2bfn1cM1gVhCH01PLXx4MYevDG12kPj6RPwbGzul1Vek7+rv5+Grya1RkvrWWJKT3oSMk4aiDkWVxx2Zyk6/j9KwzCsd/vNV4vvmwGzbghDaOPjMQPcsslCmZSISu1NN/SNSeo8dVn+neJK91cs2ft0VjBHjJByw+K0Bhr3/XpOh3sSzsgadRzHsRzexmrxspvC8TSWMZOs7lx8vHwDA5pmvHy49I4sWdcCdUUYur45ZbLXAE+WvMdqilJhHRSuo4aBkZHPbVyG0InKNXJ4brdGJi11t+/AL2VoRqc1MAbcUfJwBhZLxPLwWo7maH7I5I+a8K4t/rQGN8/g9Imzl++6UPzHjQInOUGhzgjDrMyJivBt50qrVVpeGh4fafyLB0PHeUdETV6ybMP39+xxffXAKDfGMlASGZSWYljKyOhZ0p+QojNw/JCJV3K46Bg9QxuxP5bGCslPBmXZk0x+pAI5k29oy4S0gat+OX2iENXNLxOsS8Jwd/HB2qYtA73aqfl3kxjT4PpRa9Wk2vRuEZkDuw4de7jgzw33nEpw57P/m9nN30Cr77YdeDc8XuJhUUczuOzwPIeVGUiHSUZP0qrgVYKOLBAYvLSjtQye6+4u8FR3K9BSu5xbwxbpQ5+dN3TU7Hkv14mjLHVLGObCG5M+8I1v4IpXWvgtpNR4wsJjn5rmZyMtRcY7T1e3t+Y+u2rQp/tQ8dJ73sULF5b3jPLRl7X7fOuBpzoeA+4vjVpsizbi2qtaf6TzxEs8FpchS7PYIK5BDV+FZf4sDik8tGr1HgHRcc0SRq1/5fHFB0sQOvLJ7+cd1dXUOWGYbV9PbhkY5G+4K4pos7QPGvJ+ERUGXHVaF42bq6nxQ8kpT8zb//fXv90bpfSHDxb0TWgRG8ipK4ZMSx/qoqFpUlu4xljLlIfbTY63yFl+y/+CHbIsnhtZrUHD0YylA6VIQmVtqKo8spoi460+sN+43L2ffX/ipnnnnPcVGVProjDM1YNvzxwc0tC/GUfReEzUWHQRdxSe31jL/MORtwn/Sxk5o8nTr2HH0X1T+i8+tL70UEFRAULXyqPdvJa3d+2svs183D2MHJ69VHf7RrUKh9ZSeEyktVgLGSH1DD9akqaFJWOovlynxaEe96C4FBnagMuWZbRkNmQprNIyhqvvhiZLCpyu3sMvvEVixqglm7atlelE2ToqjFB09vynw9IG+fjpTViaxiKMTGsGS8Fp8T80dkkxfMdAxi9KS7OaIK4p55OYlZby8uM9Pn6m+NZ4dAKhYhKx+G7k0tN5W3MHxTb087B84lYukFQKDo718f8yWr4G8QqPLPuM2JaB01mmQyyTJb/R6TmOPJDVBW5rWIbGywkskcYPljVKWX1bWlOKc3XzDu848qGHn3przxe/3im+Y+PZK3VYmIW/z+356pne6emRHnj0okh1MGR6szhzUVFksaVRUWSMJO8Ho6KJSV6eWm+gOJO+VVBg016BLRf1filsfeKGs28f7Zn/zTl0+8TFb8znD6N8dA5dPX/nxM/Pdo1r4uemY7QUpS5vHnmFuAjxRjweallcWmSFRwqRtaz/OB3fyjCmuwOqRSdjZElh8ktCGu9DjqLhtYVGU7k1LW9t8E8jbfSPy579f2t2fPvj4XxUZH1GrPPC7rLvyKqcx6PifNwDfBmKZii+H6BJ28/PdMQVxaszqDS8PIofoYhb8hoyoGrVrpQRj6DaBrRB7+rHevnGuvlnhI8MC5gybtH4xC8urPnh+K8nbxWhO9fOXj78y6aPlvRtG+5lYCyVQpUVSblHHJNYZHEx8W0NRwpMjxtSvIrHdWfguLvzIzHID6z8mMqytF7L4X8YMhTjOuThD/FUXmPgvhUP0z7N4wLDBvxU6Y1wFmEWzH/mb32x36SshDAvN73RgN8vLW0RxR8gYbQqVsXgOY6Ml/yMR4pNzZAmH6/FOcGzsmsAAAjHSURBVPwblqjVkolQw/9PvORjXNQ6NaWnNZynPsSXjW/fyCPzvyGJbz0/bVQhumCZCflx69C2VdO6Zw3q3zLIm5xzYnmLy99lckSFxNaQEZXT0hqGcqX5GY+Mmng45chBax0/nBpYS39KfOJtZOWBi5fULu6GcLmp+VLEKeLAWqNv9N6Kt8C5hJVz59pve36du/OFBzuH+oe4G/HEQRpIVk1GRGyPqMLVRlMqHekxNRTfX/L/sWRpRyY/WoPdkkMqGrVJpaHJoEoK0gW/UQxpRjWM2kOvM7gFBzccOLx7UtbWfY+8du018md/iTv5skNbhdf279r541erpiWHhkS28qHLCkWtLpsUSe3TGlKDnIbBZUgOg2I/ZC1hmQP5/tRiENcmcau3HGDjGAPL6qKjoyIeqPibO6mwSpxHpze8O+XhyeOHNjXGceH4p5sMf3h2JwOlxjJk4jZFrSXCcKW5kOqjVZ6kCvlNfO/CUGoWC8a/alWkL6VxJ+NO3n0ye+GfAQ1HaXQeBq+ARkGeEe36JUbtHjxrzncFV1DJs2S+2XC9IqFbqDR/94Y9x94f3jrIx/XupGjxVzacasikSCRqtfzSndFyNJGk4xsY0p/y/Q0uSs43pkXThISK6M4vrIKim9tv/bR/36icwbM7ZDZ3jzW6eOjwu4J/wFUsGRpZUmy02gM382o3rIlfUunIExrPfCx+qsY1pzaRQ2IU32cQ4xpSn2odrkWWrCJwINKvshRt8mdcXNuFxESEzR7d6+CApw9cRmjtASvnvxahH5YvWv7a+OTQBr6uDFWxAihf0JE2iZ8VGVrDsho81zEcjae9uKZtQit9M8P9JKwKpTdKDu4/+NLh53tM7ZXSK2RosHeIa2Mfg0HjQhlxu4fVuJDlnbvKpCLFh+c2ju/pVYyGUeF3VM3p+GMsGsscif8PrkBSumojRcRaRlZWhfsYXKeemgA/ivHz8vPzHT/w4ZExn66avT3v3W8XncLLwUvWUjSjkr9+2/5Ep5QHHkhv2sBAU2WruLuViB9xaJo1Bp2t2Om+FVYNN9B3pdev7/1wy4EtTz4zaE3ckNSeA0wZhoSm7qyLt5tRS3P8mEipXcknpaSwyo5sMHjhwJFS1PBNJ7/8w9I0LiqOX7+TV+AX4NUFTX4MKB+NEa8w4vSmUI8Ur1XpAYPH7n0qZfbUlwte3jlzl7m4mHwzRgnfuhf/O80r7yzYlJvdvllMYnqonmF0IU9W/gy9Pgmrljs3r6H8kvzPb27/+Oiop6etGp3Zekh0i8B4T9wYeFB46iKNCmnhyTBpmQpVHvwhMtKP8lWKR1MiF4+XKg7PhyrcimpVeGBVkQ91yBOawksRHV5aMybOp3tIh5CZc2e8uHbAl8veWzn55rffFKKreMwU+fFOvRdWHaQArh65ffX7HevHPjO039SGQQGNTS4cbvzVeixNp9KR+Y0sJTRkmc5oLEc8KY4vSLLQwNqa4ILDml3VliYVz4J8idK4j8VLAq3WRA5PugziTPENWwZOSg/ekPrzYx/9ufp2wT60m3Sh63K/m7r44IyPJq24jiotxECYOP789e+1+98bsS41edDQhm1cG/kxLgatVq/W6NWeapolK3jckriSaZAmK3U8NerI6l1P5j/StbCWdQRuNskwisdQ0sNo+A9qSZeKR1q9msXNqE7r6RWo83BtYfBv6etFTdEN7TZ0zMSKRECYzZiLC/+5kPf3oacW7ei7MCEyx7efifWkDeTIBYWHRAN/OB+3nWqDRsVS/AdDaoYc+MTV5YPri6z+1GTJyOEJU8VwKkvvaelsyJRI8Yt6nVbFqHQqE90kwqPSogGE2U/BL7e+PrLxxy3vZg4b0Os/pkA3Vw9P2oVmNWxjvB7gPyEiR9Lwf54qF5WeLBa0Kk7FqrzVKje12tLFUOTYGR5C+eUjQxYiuEy98WLCW2/4p9IfBsLkhRzDKr55eM3Kon1LR45NHzivUVdjk6gAnc5o0nFGyl0dRFaGuN6wMU88HWJ1GlZlIEWJVxN4pOSXhXydUSpXFY1XEmxi5W++BmGO4PjporySd3fOemfGzoxmLSOjdR46b20AxTJ6WoObkTCsCq/udWRhzh9WIcdnKBU511KHx83ZbSsZA2G1wM3zN385+EnOJ1+9OmjYpMEpj3iOc/EP0IUwBj2jJ5/G8VMexTEU+TinT4zXnMcr9gVhtY+5yHwDldwuuZi/f8+GPUdfHfb28PGLk+f3jhzZdWhI1+c3juhS6SRmEFanuVPp0QIIczJAmJMBwpwMEOZkgDAnA4Q5GSDMyQBhTgYIczJAmJNht7Az8a0qCGf0dqOj7Y+h195HMZioSu9wq8fsFVaFnXMk7liJP4fZH8PKz6HjY3SV4Rqx8Xk1vwaEyRQDhIkEhIlj73MSd6zEmRH2x0BZdSRGTxluO/f44ZpfI1WYWY77lchxQ+36FkOqMKCWAGFOBghzMkCYkwHCnAwQ5mSAMCcDhDkZEoWtjoj8yI4/9daE8hhSI+VGBky2N4b5kdCgJfYGQWj2UntjBBuNxpPiYkgTdjbsytmQG5J2JWzpllEWQ2qkvU2vX4ndaF8MtDmj5ILrGTuDoC/0OXb+ZYpDyaO4GNKErcAVkr1R0q6E5ZMyymJIjfQhroypi+2Lgb7chVDMSTuD5CdOybHzL3MyjTyKiyFN2JxchKa9KmlXnh8zymLYEen3RsfsjrEy5TF7Exm8LSfHzhg7gps3mCEyhjRhTy9A6ImlknblIcIsMSRHMr8SvsveGAj9tSbipH1B1j2CsDD7YuQtN5+P3iQuhjRhyyYiNMSOroMIs8SQGqm0/4NX7I2BtvyM0Ig37AvyQEikt/dMO/8yZoSmzxMXQ5qwM41vXQq5VvPrrEGEWWJIjbS+Z0UekrN5tU/hlYi9dgZBpMLsizF/UMnl2F3iYkhs61e1amlPW0+E3Y0hMdKjBi8vr1fsi4HuPBwWkmNnIogXZl+MwnGNQxeKjPH/Bj0NltjZQR8AAAAASUVORK5CYII=" title="plot of chunk unnamed-chunk-22" alt="plot of chunk unnamed-chunk-22" style="display: block; margin: auto;" /></p>

<p>Remember the currently saved model is still the last state from training! To remedy this, we overwrite the final training weights with the checkpoint weights:</p>

<pre><code class="r">model &lt;- load_model_weights_tf(model,filepath=&quot;model_weights&quot;)
</code></pre>

<p>Alternatively, we can use &ldquo;early stopping&rdquo;. This technique monitors the validation loss and stops training if it starts to increase.</p>

<pre><code class="r">#Here I&#39;m just resetting the model to it&#39;s pre-trained state
hidden.lay &lt;- input.lay %&gt;%
      layer_dense(units=12,activation = &#39;relu&#39;, name = &#39;hidden_1&#39;) %&gt;%
        layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;hidden_2&#39;) %&gt;%
          layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;hidden_3&#39;) 

output.lay &lt;- hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;linear&#39;, name = &#39;output&#39;) 

model &lt;- keras_model(
    inputs = c(input.lay), 
    outputs = c(output.lay)
  )

model %&gt;% compile(
  optimizer=&quot;adam&quot;,
  loss = &quot;mean_squared_error&quot;
)

stop &lt;- callback_early_stopping( monitor = &quot;val_loss&quot;, 
                                 patience = 5,
                                 verbose = 0,
                                 mode = &quot;min&quot;, 
                                 restore_best_weights = TRUE)
#The patience determines the number of epochs that the procedure is willing
#to wait to see if the validation loss decreases.

  history &lt;- model %&gt;% fit(
    x=X_train, y=Y_train,
    epochs = 2000, batch_size = 200,
    callback=stop,
    validation_data = list(X_valid,Y_valid)
  )

plot(history)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-24" alt="plot of chunk unnamed-chunk-24" style="display: block; margin: auto;" /></p>

<p>So you can see that early-stopped has caused the training to run for only ~400 epochs, rather than the prespecified 2000.</p>

<h2>Writing a custom loss function</h2>

<p>Sometimes the loss function that we want to use in our model is not implemented in Keras. This is particularly the case if we want to do conditional density estimation; here the loss function would be the negative log-likelihood associated with the density function.</p>

<p>Here I will show you how to write a custom loss function. We will fit a gamma distribution to toy data. Using the same predictors as before, we can create a response that follows a gamma distribution with non-stationary rate and shape parameters.</p>

<pre><code class="r">rate &lt;- abs(2+6*m/diff(range(m))); shape &lt;- abs(5+5*m/diff(range(m)))
theta &lt;- array(dim=c(dim(shape),2))
theta[,,,1]&lt;- shape; theta[,,,2]&lt;-rate
Y &lt;- apply(theta,c(1,2,3),function(x) rgamma(1,shape=x[1],rate=x[2]))
par(mfrow=c(1,3))
hist(shape)
hist(rate)
hist(Y)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-25" alt="plot of chunk unnamed-chunk-25" style="display: block; margin: auto;" /></p>

<pre><code class="r">Y_train&lt;- Y[1:1600,,]; Y_valid &lt;- Y[1601:2000,,]
</code></pre>

<p>Let&#39;s first create a model with the shape parameter for the gamma distribution fixed to some known value, e.g., 5, which we won&#39;t estimate with our model.</p>

<p>Custom loss functions in keras take in arguments <code>`r
y_true`</code> and <code>`r
y_pred`</code>; the former is our response data \(Y\) and the latter is the output from our final layer in the network. The loss function must be written using the backend functions from tensorflow and Keras to ensure that it is differentiable and hence can be used in a backpropogation framework.</p>

<pre><code class="r">gamma_nll_loss &lt;- function( y_true, y_pred) {

  K &lt;- backend() #Here&#39;s the backend functions from Keras

  rate &lt;- y_pred #The output from the final layer will be the shape parameter. 
  #This will be a function of the data whilst we fix the shape parameter to two.
  shape &lt;- 5

  return(-K$sum(
    shape*K$log(rate)-
      tensorflow::tf$math$lgamma(shape)+ 
      (shape-1)*K$log(y_true)-
      rate*y_true
  )) 
}
</code></pre>

<p>Note that I&#39;ve called <code>`r
K &lt;- backend() `</code> which is the Keras backend. This has allowed us to apply the \(\log\) function. The gamma likelihood also requires evaluation of \(\log\Gamma(\cdot)\), the \(\log\) of the gamma function. This isn&#39;t in the Keras backend, but it is in the tensorflow backend; in particularl, the mathematical functions section of the backend, which we call using <code>`r
tf$math`</code>.</p>

<p>Easy! Now let&#39;s fit a one-parameter gamma distribution to the data. It&#39;s important to remember that the rate parameter for the gamma distribution is strictly positive, so the activation function of the final layer of our network must reflect this. The model is:</p>

<pre><code class="r">hidden.lay &lt;- input.lay %&gt;%
      layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;hidden_1&#39;) %&gt;%
        layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;hidden_2&#39;) %&gt;%
          layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;hidden_3&#39;) 


output.lay &lt;- hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;exponential&#39;, name = &#39;output&#39;) 
</code></pre>

<p>with the &#39;exponential&#39; activation used to ensure that the predicted rate parameter is strictly positive.</p>

<p>We now compile our model with the new loss function and train it for 2500 epochs. Typically we need more epochs to train a CDE model (compared to a prediction model) as it&#39;s more difficult to optimise the loss. I would also recommend using a larger batch size, particularly if you expect high temporal non-stationarity in your data. Ideally (if you have the computational resources), use the full batch.</p>

<pre><code class="r">model &lt;- keras_model(
    inputs = c(input.lay), 
    outputs = c(output.lay)
  )

model %&gt;% compile(
  optimizer=&quot;adam&quot;,
  loss = gamma_nll_loss #And here we specify our loss function
)
#We will use early stopping to avoid overfitting.
checkpoint &lt;- callback_model_checkpoint(filepath = &quot;model_weights&quot;, 
                                        monitor = &quot;val_loss&quot;, verbose = 0,
                                        save_best_only = TRUE, 
                                        save_weights_only = TRUE, 
                                        mode = &quot;min&quot;,
                                        save_freq = &quot;epoch&quot;) 
history &lt;- model %&gt;% fit(
    x=X_train, y=Y_train,
    epochs = 2500, batch_size = 2000,
    callback=checkpoint,
    validation_data = list(X_valid,Y_valid)
  )
model &lt;- load_model_weights_tf(model,filepath=&quot;model_weights&quot;)
</code></pre>

<p>The training and validation losses are:</p>

<pre><code class="r">print(&quot;Training loss&quot;); print(model %&gt;% evaluate(X_train,Y_train,batch_size=2000))
</code></pre>

<pre><code>## [1] &quot;Training loss&quot;
</code></pre>

<pre><code>##     loss 
## 81094.58
</code></pre>

<pre><code class="r">print(&quot;Validation loss&quot;); print(model %&gt;% evaluate(X_valid,Y_valid,batch_size=2000))
</code></pre>

<pre><code>## [1] &quot;Validation loss&quot;
</code></pre>

<pre><code>##     loss 
## 20338.74
</code></pre>

<p>and we can retrieve the predicted rate parameters:</p>

<pre><code class="r">pred.rate &lt;- predict(model, X)
hist(rate, main=&quot;Predicted (red); true (grey)&quot;,
     breaks=seq(min(pred.rate,rate),max(pred.rate,rate),length=50))
hist(pred.rate,add=T,col=&quot;red&quot;,
     breaks=seq(min(pred.rate,rate),max(pred.rate,rate),length=50))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAGwCAIAAABHLKd9AAAACXBIWXMAAAsSAAALEgHS3X78AAAf6UlEQVR4nO3de1xUdf748c9wTxGlEg1FUR+FCIZ2EcHCCKGLml/T3cg2kVDXR+HaQ9M02k2X8tG2Rm6WZeVKa276K9cLKPkIMoFyXWlT1Lw8ErwEJDdFBIGZOef3x3yWxzjcZ44c0Nfz4R8zH8Zz3gf05ZlhOAoVN4T+/fsLIQICAu67775BgwYJIYQQL730kqqqv/76q+Xu0qVLS0pKjEZjSkqKEGL+/PmW3xseHi6ESEtL27VrlxBi6NChV69eVVV15syZQojhw4erqnrlyhUhhIeHh6qqmZmZQog777zTZDKpqjpjxgwXF5f169erqjpq1CghRF5enqqqduzF2ubNm4UQ7733nuWuJkdhERER4ezsrCiKqqqpqalCiLFjxzb9lFofS9O9Hz161Hqzubm5jdtpabBWju706dMGg6FHjx6VlZWqqk6aNEkIMX369A4deE1Njaenp8FgKCkpuXTpkouLi7+/f7NHjZY4CWjts88+q120SCxdav3r//3f/126dOl67/rkyZN5eXnnzp3z9fV98cUXk5OTGz/k7u7+6quv9u/f38XFJT8/XwixZs0ag8FgMBi+//57IcSxY8fy8vKEEJMnT/bw8BBCxMXFNbsXSwseeOABZ2dnIcSmTZuMRuNzzz1n8zAH91JRUSGE8PLysl7U5Cj69OljNpstX464uDhVVffv39/m59Zm7608rKXBWjm6Q4cOqao6btw4b29vIcS0adNa2XVL2+/Ro8fUqVNVVd29e3dmZqbJZIqNjW32qNGS1r6usM/27dsf27q1x7WLu4UIrarq06fPdd31t99+O378+GY/1KtXr549e1puW/4+v/DCCw8++GDjAwICAjZt2iSEcHKS/0yaTKZmN2VZv/XWW1sfxsG9WKa9cOGC5kdx9epVIUSPHjZforZZ791CVdWmD2tpMOvH2BxdbW2tEMLNzc1y15LylnbdyvZnzJixcePGtLS02267TQhhHUS7j/qmwhnizSgoKEgI0bNnz6eeeuqpp56qqqrKy8szGAyWv1RpaWn19fVCiC1btjT720eMGCGEsJyDCCHi4uJ69er12WefNT7Asu7gXgYPHiyE+PnnnzU/il9++aV///7u7u5C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" title="plot of chunk unnamed-chunk-30" alt="plot of chunk unnamed-chunk-30" style="display: block; margin: auto;" /></p>

<p>Not looking too bad! Let&#39;s check the fit. We&#39;ll do this by using the predicted rate parameters to transform the validation data onto standard normal margins and comparing the theoretical and empirical quantiles.</p>

<pre><code class="r">pred.rate.valid &lt;- predict(model, X_valid)
Y.norm &lt;- qnorm(pgamma(Y_train,rate=pred.rate.valid,shape = 5))
p.seq &lt;- seq(0, 1-1/length(Y.norm), length=3000)
plot(quantile(Y.norm,p.seq),qnorm(p.seq),
     ylab=&quot;Theoretical quantiles&quot;, xlab=&quot;Empirical quantiles&quot;)
abline(a=0,b=1,col=&quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-31" alt="plot of chunk unnamed-chunk-31" style="display: block; margin: auto;" /></p>

<p>Looks very good already! Let&#39;s see if we can improve the fit in the tails by simultaneously estimating the shape parameter; we will do this in the following section.</p>

<blockquote>
A quick note on saving/loading the model. 
We can save our fitted model using:

&ldquo;r
model %>% save_model_tf(file=&quot;cde_gamma_network&rdquo;)
&ldquo;
But then to load the model, we need to supply all of the custom parts of the model, e.g., the loss, custom activation functions, etc.

&rdquo;r
model <-load_model_tf(file="cde_gamma_network",
                      custom_objects = list("gamma_nll_loss"=gamma_nll_loss))
```
</blockquote>

<h2>Multi-input/output networks</h2>

<p>Thus far we have only considered a network with a single input and output. We know that the gamma distribution has two parameters, and so if we want to estimate both simultaneously we will need to create a network with two outputs. We will also give the network two inputs; this could be useful if you want to use model the parameters using different predictors or the loss function requires some extra, non-estimated inputs, e.g., the exceedance thresholds for a GPD model.</p>

<p>For illustrative purposes, we will just duplicate the predictors and input these twice. </p>

<pre><code class="r">X1 &lt;- X2 &lt;-X
X1_train &lt;- X2_train &lt;- X_train
X1_valid &lt;- X2_valid &lt;- X_valid
</code></pre>

<p>We now need two input layers</p>

<pre><code class="r">  input.lay1 &lt;- layer_input(shape = dim(X1)[2:(length(dim(X1)))], name = &#39;input_layer1&#39;)
  input.lay2 &lt;- layer_input(shape = dim(X2)[2:(length(dim(X2)))], name = &#39;input_layer2&#39;)
</code></pre>

<p>We then create two separate networks using the different inputs. One will be used for modelling the shape parameter and the other is used for modelling the rate parameter.</p>

<p>Here&#39;s the shape network:</p>

<pre><code class="r">shape.hidden.lay &lt;- input.lay1 %&gt;%
      layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;shape_hidden_1&#39;) %&gt;%
        layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;shape_hidden_2&#39;) %&gt;%
          layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;shape_hidden_3&#39;) 

shape.output.lay &lt;- shape.hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;exponential&#39;, name = &#39;shape_output&#39;)
</code></pre>

<p>and here&#39;s the rate network:</p>

<pre><code class="r">rate.hidden.lay &lt;- input.lay2 %&gt;%
      layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;rate_hidden_1&#39;) %&gt;%
        layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;rate_hidden_2&#39;) %&gt;%
          layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;rate_hidden_3&#39;)   


rate.output.lay &lt;- rate.hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;exponential&#39;, name = &#39;rate_output&#39;) 
</code></pre>

<p>In both cases we use an exponential activation to ensure that the parameters are strictly positive.</p>

<p>Recall that the loss functions take in only a single input <code>`r
y_pred`</code>. Hence we must combined the two networks together now so that they create a single tensor as input to our custom loss function.</p>

<pre><code class="r">output.joined.lay &lt;- layer_concatenate(c(shape.output.lay,rate.output.lay))
</code></pre>

<p>The final axes of the tensor <code>`r
output.joined.lay`</code> will have length two, with the first index being the predicted shape parameter and the second being the rate parameter. We can adapt our custom loss function accordingly.</p>

<pre><code class="r">gamma_nll_loss &lt;- function( y_true, y_pred) {

  K &lt;- backend() 

  shape &lt;- y_pred[tensorflow::all_dims(),1] 
  rate &lt;- y_pred[tensorflow::all_dims(),2]
  #The all_dims() function just ensures that its the last axis that is indexed.
  #This can be very useful if the shape of the tensor isn&#39;t known.

  return(-K$sum(
    shape*K$log(rate)-
     tensorflow::tf$math$lgamma(shape)+ 
      (shape-1)*K$log(y_true)-
      rate*y_true
  )) 
}
</code></pre>

<p>And now we can compile and train our model. Remember that we have two inputs now.</p>

<pre><code class="r">model &lt;- keras_model(
    inputs = c(input.lay1,input.lay2), 
    outputs = c(output.joined.lay)
  )
model %&gt;% compile(
  optimizer=&quot;adam&quot;,
  loss = gamma_nll_loss #And here we specify our loss function
)
checkpoint &lt;- callback_model_checkpoint(filepath = &quot;model_weights&quot;, 
                                        monitor = &quot;val_loss&quot;, verbose = 0,
                                        save_best_only = TRUE, 
                                        save_weights_only = TRUE, 
                                        mode = &quot;min&quot;,
                                        save_freq = &quot;epoch&quot;) 
  history &lt;- model %&gt;% fit(
    list(X1_train,X2_train), Y_train,
    epochs = 2500, batch_size = 2000,
    callback=checkpoint,
    validation_data = list(list(X1_valid,X2_valid),Y_valid)
  )
plot(history)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-40" alt="plot of chunk unnamed-chunk-40" style="display: block; margin: auto;" /></p>

<pre><code class="r">model &lt;- load_model_weights_tf(model,filepath=&quot;model_weights&quot;)
</code></pre>

<p>Then we can get the predicted parameters:</p>

<pre><code class="r">preds &lt;- model %&gt;% predict( list(X1,X2))
pred.shape&lt;-preds[,,,1]
pred.rate&lt;-preds[,,,2]
par(mfrow=c(2,2))
hist(shape, main=&quot;Predicted (red); true (grey)&quot;,
     breaks=seq(min(pred.shape,shape),max(pred.shape,shape),length=50))
hist(pred.shape,add=T,col=&quot;red&quot;, 
     breaks=seq(min(pred.shape,shape),max(pred.shape,shape),length=50))
hist(rate, main=&quot;Predicted (red); true (grey)&quot;,
     breaks=seq(min(pred.rate,rate),max(pred.rate,rate),length=50))
hist(pred.rate,add=T,col=&quot;red&quot;, 
     breaks=seq(min(pred.rate,rate),max(pred.rate,rate),length=50))
plot(pred.shape,shape)
abline(a=0,b=1,col=&quot;red&quot;)

plot(pred.rate,rate)
abline(a=0,b=1,col=&quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-41" alt="plot of chunk unnamed-chunk-41" style="display: block; margin: auto;" /></p>

<p>and check the fit.</p>

<pre><code class="r">preds.valid &lt;- model %&gt;% predict( list(X1_valid,X2_valid))
pred.shape.valid&lt;-preds[,,,1]
pred.rate.valid&lt;-preds[,,,2]
Y.norm &lt;- qnorm(pgamma(Y_valid,shape=pred.shape.valid,rate = pred.rate.valid))
p.seq &lt;- seq(0, 1-1/length(Y.norm), length=3000)
plot(quantile(Y.norm,p.seq),qnorm(p.seq), ylab=&quot;Theoretical quantiles&quot;, 
     xlab=&quot;Empirical quantiles&quot;)
abline(a=0,b=1,col=&quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-42" alt="plot of chunk unnamed-chunk-42" style="display: block; margin: auto;" /></p>

<pre><code class="r">print(&quot;Training loss&quot;); model %&gt;% evaluate(list(X1_train,X2_train),
                                           Y_train,batch_size=2000)
</code></pre>

<pre><code>## [1] &quot;Training loss&quot;
</code></pre>

<pre><code>##     loss 
## 80956.88
</code></pre>

<pre><code class="r">print(&quot;Validation loss&quot;); model %&gt;% evaluate(list(X1_valid,X2_valid),
                                             Y_valid,batch_size=2000)
</code></pre>

<pre><code>## [1] &quot;Validation loss&quot;
</code></pre>

<pre><code>##     loss 
## 20337.96
</code></pre>

<p>Are we doing much better? Maybe, but not dramatically so. Even though we know that the underlying distribution that generates the response is highly non-stationary in both parameters, it seems that fixing the shape to 5 and modelling only the rate parameter already gives a satisfactory fit. Why could this be?</p>

<ul>
<li>Maybe we need more data to train the two-parameter model? This uses two neural networks, and so requires estimation of twice as many parameters</li>
<li>If a neural network has lots of parameters, there&#39;s no guarantee that the log-likelihood/loss function is convex. We could have gotten stuck in a local minima during training (something to look out for!)</li>
<li>We could use a less complex network for the shape parameter as this is </li>
<li>Or maybe we can even keep the shape parameter constant over all indices, but estimate this jointly with the non-stationary rate parameter (rather than fixing it at 5). Here&#39;s a quick tip to on how to achieve this; we can rewrite the hidden layers for the shape parameter in the following way:</li>
</ul>

<pre><code class="r">shape.hidden.lay &lt;- input.lay1 %&gt;%
      layer_dense(units=1,activation = &#39;linear&#39;, name = &#39;shape_hidden_1&#39;,
                  trainable=F,
                  weights=list(matrix(0,nrow=dim(X1)[length(dim(X1))],ncol=1),
                               array(1,dim=1))) 

shape.output.lay &lt;- shape.hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;exponential&#39;, name = &#39;shape_output&#39;, use_bias = F)
</code></pre>

<p>The <code>`r
trainable=F`</code> argument means that the weights and biases of the first layer are fixed; they do not update during training. I&#39;ve then supplied initial weights and biases through the <code></code>r
weight<code></code> argument; we have a matrix of all zero weights and a bias of one. That means that the first layer will output a single constant value, one, regardless of the input. The second layer does not have any biases; only a single trainable weight. This will be multiplied by the one from the output of the first layer and, as the weight takes any real value, we can get shape parameter (with range controlled by the second activation function) fixed over all inputs.</p>

<p>Let&#39;s build and train a model with a homogeneous shape parameter. First the shape network:</p>

<pre><code class="r">init.shape&lt;-5
shape.hidden.lay &lt;- input.lay1 %&gt;%
      layer_dense(units=1,activation = &#39;linear&#39;, name = &#39;shape_hidden_1&#39;,
                  trainable=F,
                  weights=list(matrix(0,nrow=dim(X1)[length(dim(X1))],ncol=1),
                               array(1,dim=1))) 

shape.output.lay &lt;- shape.hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;exponential&#39;, name = &#39;shape_output&#39;, use_bias = F,
                  weights=list(as.matrix(log(init.shape))))
</code></pre>

<p>Here I&#39;ve set the initial weight in the output layer to \(\log(5)\). We know that the weights of the previous layer are all zeroes and the bias is one, so this means that the initial homogeneous shape parameter will be \(\exp(\log(5))=5\), thanks to the exponential activation.</p>

<pre><code class="r">rate.hidden.lay &lt;- input.lay2 %&gt;%
      layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;rate_hidden_1&#39;) %&gt;%
        layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;rate_hidden_2&#39;) %&gt;%
          layer_dense(units=8,activation = &#39;relu&#39;, name = &#39;rate_hidden_3&#39;)   


rate.output.lay &lt;- rate.hidden.lay %&gt;%
      layer_dense(units=1,activation = &#39;exponential&#39;, name = &#39;rate_output&#39;) 

output.joined.lay &lt;- layer_concatenate(c(shape.output.lay,rate.output.lay))

model &lt;- keras_model(
    inputs = c(input.lay1,input.lay2), 
    outputs = c(output.joined.lay)
  )
model %&gt;% compile(
  optimizer=&quot;adam&quot;,
  loss = gamma_nll_loss #And here we specify our loss function
)
checkpoint &lt;- callback_model_checkpoint(filepath = &quot;model_weights&quot;, 
                                        monitor = &quot;val_loss&quot;, verbose = 0,
                                        save_best_only = TRUE, 
                                        save_weights_only = TRUE, 
                                        mode = &quot;min&quot;,
                                        save_freq = &quot;epoch&quot;) 
  history &lt;- model %&gt;% fit(
    list(X1_train,X2_train), Y_train,
    epochs = 2500, batch_size = 2000,
    callback=checkpoint,
    validation_data = list(list(X1_valid,X2_valid),Y_valid)
  )
plot(history)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-45" alt="plot of chunk unnamed-chunk-45" style="display: block; margin: auto;" /></p>

<pre><code class="r">model &lt;- load_model_weights_tf(model,filepath=&quot;model_weights&quot;)

preds &lt;- model %&gt;% predict( list(X1,X2))
pred.shape&lt;-preds[,,,1]
pred.rate&lt;-preds[,,,2]
print(&quot;Estimated shape:&quot;);   print(mean(pred.shape))
</code></pre>

<pre><code>## [1] &quot;Estimated shape:&quot;
</code></pre>

<pre><code>## [1] 4.983407
</code></pre>

<pre><code class="r">par(mfrow=c(2,2))
hist(shape, main=&quot;Predicted (red); true (grey)&quot;,
     breaks=seq(min(pred.shape,shape),max(pred.shape,shape),length=50))

hist(pred.shape,add=T,col=&quot;red&quot;, 
     breaks=seq(min(pred.shape,shape),max(pred.shape,shape),length=50))
hist(rate, main=&quot;Predicted (red); true (grey)&quot;,
     breaks=seq(min(pred.rate,rate),max(pred.rate,rate),length=50))
hist(pred.rate,add=T,col=&quot;red&quot;, 
     breaks=seq(min(pred.rate,rate),max(pred.rate,rate),length=50))
</code></pre>

<p><img src="data:image/png;base64,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AhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEYkYJ1oAAAFASURBVAAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQAUAhEAFAIRABQCEQCU/w/yQikm+ivnVwAAAABJRU5ErkJggg==" title="plot of chunk unnamed-chunk-45" alt="plot of chunk unnamed-chunk-45" style="display: block; margin: auto;" /></p>

<p>and check the fit.</p>

<pre><code class="r">preds.valid &lt;- model %&gt;% predict( list(X1_valid,X2_valid))
pred.shape.valid&lt;-preds[,,,1]
pred.rate.valid&lt;-preds[,,,2]
Y.norm &lt;- qnorm(pgamma(Y_valid,shape=pred.shape.valid,rate = pred.rate.valid))
p.seq &lt;- seq(0, 1-1/length(Y.norm), length=3000)
plot(quantile(Y.norm,p.seq),qnorm(p.seq), ylab=&quot;Theoretical quantiles&quot;, 
     xlab=&quot;Empirical quantiles&quot;)
abline(a=0,b=1,col=&quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-46" alt="plot of chunk unnamed-chunk-46" style="display: block; margin: auto;" /></p>

<pre><code class="r">print(&quot;Training loss&quot;); model %&gt;% evaluate(list(X1_train,X2_train),
                                           Y_train,batch_size=2000)
</code></pre>

<pre><code>## [1] &quot;Training loss&quot;
</code></pre>

<pre><code>##     loss 
## 81043.25
</code></pre>

<pre><code class="r">print(&quot;Validation loss&quot;); model %&gt;% evaluate(list(X1_valid,X2_valid),
                                             Y_valid,batch_size=2000)
</code></pre>

<pre><code>## [1] &quot;Validation loss&quot;
</code></pre>

<pre><code>##    loss 
## 20301.7
</code></pre>

<p>Which model should we pick? We should expect the more complicated model to give the best predictions, but due to the practicalities of training a deep learning model this might not always be the case! Sometimes it&#39;s better to opt for parsimonity over complexity.</p>

<pre><code>
The R session information (including the OS info, R version and all
packages used):


```r
sessionInfo()
</code></pre>

<pre><code>## R version 4.2.1 (2022-06-23)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] keras_2.9.0
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.8.3     lattice_0.20-45  png_0.1-7        zeallot_0.1.0   
##  [5] grid_4.2.1       R6_2.5.1         jsonlite_1.8.0   magrittr_2.0.3  
##  [9] evaluate_0.15    highr_0.9        tfruns_1.5.0     cli_3.3.0       
## [13] rlang_1.0.3      stringi_1.7.6    whisker_0.4      Matrix_1.4-1    
## [17] ellipsis_0.3.2   reticulate_1.25  generics_0.1.3   tools_4.2.1     
## [21] stringr_1.4.0    xfun_0.31        compiler_4.2.1   base64enc_0.1-3 
## [25] tensorflow_2.9.0 knitr_1.39
</code></pre>

<pre><code class="r">Sys.time()
</code></pre>

<pre><code>## [1] &quot;2022-07-09 12:16:30 +03&quot;
</code></pre>

</body>

</html>
